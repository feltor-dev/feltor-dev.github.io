<!-- HTML header for doxygen 1.9.3-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Discontinuous Galerkin Library: dg::AndersonAcceleration&lt; ContainerType &gt; Struct Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?.../MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="menubar.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
    <!--My own title area-->
  <ul class="menubar">
      <!-- <li><a href="../../../index.html">/</a><li>-->
    <li><a href="../../dg/html/modules.html">dg</a></li>
    <li><a href="../../geometries/html/modules.html">dg::geo</a></li>
    <li><a href="../../file/html/modules.html">dg::file</a></li>
    <li><a href="../../exblas/html/namespacedg_1_1exblas.html">dg::exblas</a></li>
  </ul>
  <!--End My own title area-->
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Discontinuous Galerkin Library
   </div>
   <div id="projectbrief">#include &quot;dg/algorithm.h&quot;</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('structdg_1_1_anderson_acceleration.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="structdg_1_1_anderson_acceleration-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">dg::AndersonAcceleration&lt; ContainerType &gt; Struct Template Reference<div class="ingroups"><a class="el" href="group__numerical0.html">Level 2: Basic numerical algorithms</a> &raquo; <a class="el" href="group__invert.html">Linear and nonlinear solvers</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Anderson Acceleration of Fixed Point/Richardson Iteration for the nonlinear equation.  
 <a href="structdg_1_1_anderson_acceleration.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a9465ebba6cf44a11b5b9d60721c98af7"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdg_1_1_anderson_acceleration.html#a9465ebba6cf44a11b5b9d60721c98af7">value_type</a> = <a class="el" href="group__dispatch.html#ga6cca187a5557469a96917dc4687a22d3">get_value_type</a>&lt; ContainerType &gt;</td></tr>
<tr class="memdesc:a9465ebba6cf44a11b5b9d60721c98af7"><td class="mdescLeft">&#160;</td><td class="mdescRight">the value type of the time variable (float or double)  <a href="structdg_1_1_anderson_acceleration.html#a9465ebba6cf44a11b5b9d60721c98af7">More...</a><br /></td></tr>
<tr class="separator:a9465ebba6cf44a11b5b9d60721c98af7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afffe938176e76d9cf804dfb227b129ea"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdg_1_1_anderson_acceleration.html#afffe938176e76d9cf804dfb227b129ea">container_type</a> = ContainerType</td></tr>
<tr class="separator:afffe938176e76d9cf804dfb227b129ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1212805578b60f3e909ec57c888de688"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdg_1_1_anderson_acceleration.html#a1212805578b60f3e909ec57c888de688">AndersonAcceleration</a> ()</td></tr>
<tr class="memdesc:a1212805578b60f3e909ec57c888de688"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate nothing, Call <code>construct</code> method before usage.  <a href="structdg_1_1_anderson_acceleration.html#a1212805578b60f3e909ec57c888de688">More...</a><br /></td></tr>
<tr class="separator:a1212805578b60f3e909ec57c888de688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e9d623588bcc0031554aa825e64f959"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdg_1_1_anderson_acceleration.html#a4e9d623588bcc0031554aa825e64f959">AndersonAcceleration</a> (const ContainerType &amp;<a class="el" href="structdg_1_1_anderson_acceleration.html#a256642f890c394e0766cc9be1e23bc46">copyable</a>)</td></tr>
<tr class="memdesc:a4e9d623588bcc0031554aa825e64f959"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate memory for Fixed point iteration.  <a href="structdg_1_1_anderson_acceleration.html#a4e9d623588bcc0031554aa825e64f959">More...</a><br /></td></tr>
<tr class="separator:a4e9d623588bcc0031554aa825e64f959"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74d41837c605126bb546f4892b844bb1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdg_1_1_anderson_acceleration.html#a74d41837c605126bb546f4892b844bb1">AndersonAcceleration</a> (const ContainerType &amp;<a class="el" href="structdg_1_1_anderson_acceleration.html#a256642f890c394e0766cc9be1e23bc46">copyable</a>, unsigned mMax)</td></tr>
<tr class="memdesc:a74d41837c605126bb546f4892b844bb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate memory for the object.  <a href="structdg_1_1_anderson_acceleration.html#a74d41837c605126bb546f4892b844bb1">More...</a><br /></td></tr>
<tr class="separator:a74d41837c605126bb546f4892b844bb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7f0b45c58dc4ca6c151402c5e9d8c2c"><td class="memTemplParams" colspan="2">template&lt;class ... Params&gt; </td></tr>
<tr class="memitem:af7f0b45c58dc4ca6c151402c5e9d8c2c"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="structdg_1_1_anderson_acceleration.html#af7f0b45c58dc4ca6c151402c5e9d8c2c">construct</a> (Params &amp;&amp;...ps)</td></tr>
<tr class="memdesc:af7f0b45c58dc4ca6c151402c5e9d8c2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perfect forward parameters to one of the constructors.  <a href="structdg_1_1_anderson_acceleration.html#af7f0b45c58dc4ca6c151402c5e9d8c2c">More...</a><br /></td></tr>
<tr class="separator:af7f0b45c58dc4ca6c151402c5e9d8c2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a256642f890c394e0766cc9be1e23bc46"><td class="memItemLeft" align="right" valign="top">const ContainerType &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdg_1_1_anderson_acceleration.html#a256642f890c394e0766cc9be1e23bc46">copyable</a> () const</td></tr>
<tr class="memdesc:a256642f890c394e0766cc9be1e23bc46"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return an object of same size as the object used for construction.  <a href="structdg_1_1_anderson_acceleration.html#a256642f890c394e0766cc9be1e23bc46">More...</a><br /></td></tr>
<tr class="separator:a256642f890c394e0766cc9be1e23bc46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae93383e761b947f511e025a53a6da521"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdg_1_1_anderson_acceleration.html#ae93383e761b947f511e025a53a6da521">set_throw_on_fail</a> (bool throw_on_fail)</td></tr>
<tr class="memdesc:ae93383e761b947f511e025a53a6da521"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set or unset a throw on failure-to-converge.  <a href="structdg_1_1_anderson_acceleration.html#ae93383e761b947f511e025a53a6da521">More...</a><br /></td></tr>
<tr class="separator:ae93383e761b947f511e025a53a6da521"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa882b79ab54adb47fef188aae8b246c4"><td class="memTemplParams" colspan="2">template&lt;class MatrixType , class ContainerType0 , class ContainerType1 , class ContainerType2 &gt; </td></tr>
<tr class="memitem:aa882b79ab54adb47fef188aae8b246c4"><td class="memTemplItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="structdg_1_1_anderson_acceleration.html#aa882b79ab54adb47fef188aae8b246c4">solve</a> (MatrixType &amp;&amp;f, ContainerType0 &amp;x, const ContainerType1 &amp;b, const ContainerType2 &amp;weights, <a class="el" href="structdg_1_1_anderson_acceleration.html#a9465ebba6cf44a11b5b9d60721c98af7">value_type</a> rtol, <a class="el" href="structdg_1_1_anderson_acceleration.html#a9465ebba6cf44a11b5b9d60721c98af7">value_type</a> atol, unsigned max_iter, <a class="el" href="structdg_1_1_anderson_acceleration.html#a9465ebba6cf44a11b5b9d60721c98af7">value_type</a> damping, unsigned restart, bool verbose)</td></tr>
<tr class="memdesc:aa882b79ab54adb47fef188aae8b246c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve the system \( f(x) = b \) in the given norm.  <a href="structdg_1_1_anderson_acceleration.html#aa882b79ab54adb47fef188aae8b246c4">More...</a><br /></td></tr>
<tr class="separator:aa882b79ab54adb47fef188aae8b246c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;class ContainerType&gt;<br />
struct dg::AndersonAcceleration&lt; ContainerType &gt;</div><p >Anderson Acceleration of Fixed Point/Richardson Iteration for the nonlinear equation. </p>
<p class="formulaDsp">
\[ f(x) = b\]
</p>
<p >This class implements the Anderson acceleration of the fixed point iteration algorithm described by <a href="https://users.wpi.edu/~walker/Papers/Walker-Ni,SINUM,V49,1715-1735.pdf">https://users.wpi.edu/~walker/Papers/Walker-Ni,SINUM,V49,1715-1735.pdf</a> with implementation details in //https://users.wpi.edu/~walker/Papers/anderson_accn_algs_imps.pdf As recommended by <a href="https://arxiv.org/pdf/1803.06673.pdf">https://arxiv.org/pdf/1803.06673.pdf</a> we periodically restart the acceleration to improve convergence behaviour.</p>
<div class="fragment"><div class="line">    <span class="comment">// create volume on previously defined grid</span></div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_typedef" href="group__typedefs.html#ga4fb8e78e7b043edfedb880523f0cd193">dg::HVec</a> w2d = <a class="code hl_function" href="group__highlevel.html#ga7b869566cb76ee5eb9eaaa95abc65fb0">dg::create::weights</a>( grid);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create normalized Laplacian</span></div>
<div class="line">    <a class="code hl_class" href="classdg_1_1_elliptic.html">dg::Elliptic&lt;dg::CartesianGrid2d, dg::HMatrix, dg::HVec&gt;</a> A( grid);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// allocate memory</span></div>
<div class="line">    <a class="code hl_struct" href="structdg_1_1_anderson_acceleration.html">dg::AndersonAcceleration&lt;dg::HVec &gt;</a> acc( copyable_vector, 10);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Evaluate right hand side and solution on the grid</span></div>
<div class="line">    <a class="code hl_typedef" href="group__typedefs.html#ga4fb8e78e7b043edfedb880523f0cd193">dg::HVec</a> b = <a class="code hl_function" href="group__evaluation.html#gac802d2b4de66df9ce2282e378461ce28">dg::evaluate</a> ( laplace_fct, grid);</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_typedef" href="group__typedefs.html#ga4fb8e78e7b043edfedb880523f0cd193">dg::HVec</a> solution = <a class="code hl_function" href="group__evaluation.html#gac802d2b4de66df9ce2282e378461ce28">dg::evaluate</a> ( fct, grid);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> eps = 1e-6;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Number of iterations &quot;</span>&lt;&lt; acc.solve( A, x, b, w2d, eps, eps, max_iter, damping, restart, <span class="keyword">true</span>)&lt;&lt;std::endl;</div>
<div class="ttc" id="aclassdg_1_1_elliptic_html"><div class="ttname"><a href="classdg_1_1_elliptic.html">dg::Elliptic</a></div><div class="ttdoc">A 2d negative elliptic differential operator .</div><div class="ttdef"><b>Definition:</b> elliptic.h:73</div></div>
<div class="ttc" id="agroup__evaluation_html_gac802d2b4de66df9ce2282e378461ce28"><div class="ttname"><a href="group__evaluation.html#gac802d2b4de66df9ce2282e378461ce28">dg::evaluate</a></div><div class="ttdeci">thrust::host_vector&lt; real_type &gt; evaluate(UnaryOp f, const RealGrid1d&lt; real_type &gt; &amp;g)</div><div class="ttdoc">Evaluate a 1d function on grid coordinates.</div><div class="ttdef"><b>Definition:</b> evaluation.h:67</div></div>
<div class="ttc" id="agroup__highlevel_html_ga7b869566cb76ee5eb9eaaa95abc65fb0"><div class="ttname"><a href="group__highlevel.html#ga7b869566cb76ee5eb9eaaa95abc65fb0">dg::create::weights</a></div><div class="ttdeci">MPI_Vector&lt; thrust::host_vector&lt; real_type &gt; &gt; weights(const aRealMPITopology2d&lt; real_type &gt; &amp;g)</div><div class="ttdoc">Nodal weight coefficients.</div><div class="ttdef"><b>Definition:</b> mpi_weights.h:22</div></div>
<div class="ttc" id="agroup__typedefs_html_ga4fb8e78e7b043edfedb880523f0cd193"><div class="ttname"><a href="group__typedefs.html#ga4fb8e78e7b043edfedb880523f0cd193">dg::HVec</a></div><div class="ttdeci">thrust::host_vector&lt; double &gt; HVec</div><div class="ttdoc">Host Vector.</div><div class="ttdef"><b>Definition:</b> typedefs.h:19</div></div>
<div class="ttc" id="astructdg_1_1_anderson_acceleration_html"><div class="ttname"><a href="structdg_1_1_anderson_acceleration.html">dg::AndersonAcceleration</a></div><div class="ttdoc">Anderson Acceleration of Fixed Point/Richardson Iteration for the nonlinear equation.</div><div class="ttdef"><b>Definition:</b> andersonacc.h:61</div></div>
</div><!-- fragment --><dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">ContainerType</td><td>Any class for which a specialization of <code><a class="el" href="structdg_1_1_tensor_traits.html" title="The vector traits.">TensorTraits</a></code> exists and which fulfills the requirements of the there defined data and execution policies derived from <code><a class="el" href="structdg_1_1_any_vector_tag.html" title="Vector Tag base class, indicates the basic Vector/container concept.">AnyVectorTag</a></code> and <code><a class="el" href="structdg_1_1_any_policy_tag.html" title="Execution Policy base class.">AnyPolicyTag</a></code>. Among others<ul>
<li><code> <a class="el" href="group__typedefs.html#ga4fb8e78e7b043edfedb880523f0cd193" title="Host Vector.">dg::HVec</a> (serial), <a class="el" href="group__typedefs.html#ga5bbe4ba51ef8ff8d506979d0beda25b8" title="Device Vector. The device can be an OpenMP parallelized cpu or a gpu. This depends on the value of th...">dg::DVec</a> (cuda / omp), <a class="el" href="group__typedefs.html#gac127f65b65c035ebe413aee5abffd6f0" title="MPI Host Vector s.a. dg::HVec.">dg::MHVec</a> (mpi + serial) or <a class="el" href="group__typedefs.html#ga1e23fb8b50d38d43beb4bf3689c20a55" title="MPI Device Vector s.a. dg::DVec.">dg::MDVec</a> (mpi + cuda / omp) </code></li>
<li><code> std::vector&lt;dg::DVec&gt; </code> (vector of shared device vectors), <code> std::array&lt;double, 4&gt; </code> (array of 4 doubles) or <code> std::map &lt; std::string, <a class="el" href="group__typedefs.html#ga5bbe4ba51ef8ff8d506979d0beda25b8" title="Device Vector. The device can be an OpenMP parallelized cpu or a gpu. This depends on the value of th...">dg::DVec</a>&gt; </code> ( a map of named vectors)</li>
<li><code> double (scalar)</code> and other primitive types ...</li>
</ul>
If there are several <code>ContainerTypes</code> in the argument list, then <code><a class="el" href="structdg_1_1_tensor_traits.html" title="The vector traits.">TensorTraits</a></code> must exist for all of them </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>See <a class="el" href="group__blas.html#dispatch">The dg dispatch system</a> for a detailed explanation of our type dispatch system </dd></dl>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="afffe938176e76d9cf804dfb227b129ea" name="afffe938176e76d9cf804dfb227b129ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afffe938176e76d9cf804dfb227b129ea">&#9670;&nbsp;</a></span>container_type</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ContainerType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="structdg_1_1_anderson_acceleration.html">dg::AndersonAcceleration</a>&lt; ContainerType &gt;::container_type =  ContainerType</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >the type of the vector class in use </p>

</div>
</div>
<a id="a9465ebba6cf44a11b5b9d60721c98af7" name="a9465ebba6cf44a11b5b9d60721c98af7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9465ebba6cf44a11b5b9d60721c98af7">&#9670;&nbsp;</a></span>value_type</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ContainerType &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="structdg_1_1_anderson_acceleration.html">dg::AndersonAcceleration</a>&lt; ContainerType &gt;::value_type =  <a class="el" href="group__dispatch.html#ga6cca187a5557469a96917dc4687a22d3">get_value_type</a>&lt;ContainerType&gt;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the value type of the time variable (float or double) </p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a1212805578b60f3e909ec57c888de688" name="a1212805578b60f3e909ec57c888de688"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1212805578b60f3e909ec57c888de688">&#9670;&nbsp;</a></span>AndersonAcceleration() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ContainerType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdg_1_1_anderson_acceleration.html">dg::AndersonAcceleration</a>&lt; ContainerType &gt;::AndersonAcceleration </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocate nothing, Call <code>construct</code> method before usage. </p>

</div>
</div>
<a id="a4e9d623588bcc0031554aa825e64f959" name="a4e9d623588bcc0031554aa825e64f959"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e9d623588bcc0031554aa825e64f959">&#9670;&nbsp;</a></span>AndersonAcceleration() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ContainerType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdg_1_1_anderson_acceleration.html">dg::AndersonAcceleration</a>&lt; ContainerType &gt;::AndersonAcceleration </td>
          <td>(</td>
          <td class="paramtype">const ContainerType &amp;&#160;</td>
          <td class="paramname"><em>copyable</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocate memory for Fixed point iteration. </p>
<p >This version sets mMax to zero reducing the solve method to Fixed Point (or Richardson if the damping parameter is != 1 in the <code><a class="el" href="structdg_1_1_anderson_acceleration.html#aa882b79ab54adb47fef188aae8b246c4" title="Solve the system  in the given norm.">solve()</a></code> method) iteration </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">copyable</td><td>A ContainerType must be copy-constructible from this </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a74d41837c605126bb546f4892b844bb1" name="a74d41837c605126bb546f4892b844bb1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74d41837c605126bb546f4892b844bb1">&#9670;&nbsp;</a></span>AndersonAcceleration() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ContainerType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdg_1_1_anderson_acceleration.html">dg::AndersonAcceleration</a>&lt; ContainerType &gt;::AndersonAcceleration </td>
          <td>(</td>
          <td class="paramtype">const ContainerType &amp;&#160;</td>
          <td class="paramname"><em>copyable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>mMax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocate memory for the object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">copyable</td><td>A ContainerType must be copy-constructible from this </td></tr>
    <tr><td class="paramname">mMax</td><td>The maximum number of vectors to include in the optimization procedure. <code>mMax+1</code> is the number of solutions involved in computing the new solution. Something between 3 and 10 are good values but higher values mean more storage space that needs to be reserved. If <code>mMax==0</code> then the algorithm is equivalent to Fixed Point (or Richardson if the damping parameter is != 1 in the <code><a class="el" href="structdg_1_1_anderson_acceleration.html#aa882b79ab54adb47fef188aae8b246c4" title="Solve the system  in the given norm.">solve()</a></code> method) iteration i.e. no optimization and only 1 solution needed to compute a new solution. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="af7f0b45c58dc4ca6c151402c5e9d8c2c" name="af7f0b45c58dc4ca6c151402c5e9d8c2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7f0b45c58dc4ca6c151402c5e9d8c2c">&#9670;&nbsp;</a></span>construct()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ContainerType &gt; </div>
<div class="memtemplate">
template&lt;class ... Params&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="structdg_1_1_anderson_acceleration.html">dg::AndersonAcceleration</a>&lt; ContainerType &gt;::construct </td>
          <td>(</td>
          <td class="paramtype">Params &amp;&amp;...&#160;</td>
          <td class="paramname"><em>ps</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perfect forward parameters to one of the constructors. </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Params</td><td>deduced by the compiler </td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ps</td><td>parameters forwarded to constructors </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a256642f890c394e0766cc9be1e23bc46" name="a256642f890c394e0766cc9be1e23bc46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a256642f890c394e0766cc9be1e23bc46">&#9670;&nbsp;</a></span>copyable()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ContainerType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const ContainerType &amp; <a class="el" href="structdg_1_1_anderson_acceleration.html">dg::AndersonAcceleration</a>&lt; ContainerType &gt;::copyable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return an object of same size as the object used for construction. </p>
<dl class="section return"><dt>Returns</dt><dd>A copyable object; what it contains is undefined, its size is important </dd></dl>

</div>
</div>
<a id="ae93383e761b947f511e025a53a6da521" name="ae93383e761b947f511e025a53a6da521"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae93383e761b947f511e025a53a6da521">&#9670;&nbsp;</a></span>set_throw_on_fail()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ContainerType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="structdg_1_1_anderson_acceleration.html">dg::AndersonAcceleration</a>&lt; ContainerType &gt;::set_throw_on_fail </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>throw_on_fail</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set or unset a throw on failure-to-converge. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">throw_on_fail</td><td>If true, the solve method will thow a <a class="el" href="structdg_1_1_fail.html" title="Indicate failure to converge.">dg::Fail</a> if it is unable to converge </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>the default value is true </dd></dl>

</div>
</div>
<a id="aa882b79ab54adb47fef188aae8b246c4" name="aa882b79ab54adb47fef188aae8b246c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa882b79ab54adb47fef188aae8b246c4">&#9670;&nbsp;</a></span>solve()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class ContainerType &gt; </div>
<div class="memtemplate">
template&lt;class MatrixType , class ContainerType0 , class ContainerType1 , class ContainerType2 &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="structdg_1_1_anderson_acceleration.html">dg::AndersonAcceleration</a>&lt; ContainerType &gt;::solve </td>
          <td>(</td>
          <td class="paramtype">MatrixType &amp;&amp;&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ContainerType0 &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ContainerType1 &amp;&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ContainerType2 &amp;&#160;</td>
          <td class="paramname"><em>weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdg_1_1_anderson_acceleration.html#a9465ebba6cf44a11b5b9d60721c98af7">value_type</a>&#160;</td>
          <td class="paramname"><em>rtol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdg_1_1_anderson_acceleration.html#a9465ebba6cf44a11b5b9d60721c98af7">value_type</a>&#160;</td>
          <td class="paramname"><em>atol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdg_1_1_anderson_acceleration.html#a9465ebba6cf44a11b5b9d60721c98af7">value_type</a>&#160;</td>
          <td class="paramname"><em>damping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>restart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>verbose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Solve the system \( f(x) = b \) in the given norm. </p>
<p >Iterates until \( ||f(x)-b|| &lt; a_{\mathrm{tol}} + r_{\mathrm{tol}} ||b||\)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>The function <code>y=f(x)</code> in the form <code>f(x,y)</code>. The first argument is the input and the second the output. </td></tr>
    <tr><td class="paramname">x</td><td>Contains an initial guess on input and the solution on output. </td></tr>
    <tr><td class="paramname">b</td><td>The right hand side vector. </td></tr>
    <tr><td class="paramname">weights</td><td>The weights define the norm for the stopping condition of the solver and the scalar product in which the least square problem is computed </td></tr>
    <tr><td class="paramname">rtol</td><td>Relative error condition with respect to <code>b</code> </td></tr>
    <tr><td class="paramname">atol</td><td>Absolute error condition </td></tr>
    <tr><td class="paramname">max_iter</td><td>Maxmimum number of iterations </td></tr>
    <tr><td class="paramname">damping</td><td>Paramter to prevent too large jumps around the actual solution. Hard to determine in general but values between 1e-2 and 1e-4 are good values to begin with. This is the parameter that appears in Richardson iteration. It is beter to have it too small than too large (where it can lead to divergence of the solver) </td></tr>
    <tr><td class="paramname">restart</td><td>Number &gt;= mMax that indicates after how many iterations to restart the acceleration. Periodic restarts are important for this method. Per default it should be the same value as <code>mMax</code> but <code>mMax+1</code> or higher could be valuable to consider (but usually are worse than <code>mMax</code>). Lower values <code>restart&lt;mMax</code> are equivalent to setting <code>mMax=restart</code>. </td></tr>
    <tr><td class="paramname">verbose</td><td>If true writes intermediate errors to <code>std::cout</code> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of iterations used to achieve desired precision </dd></dl>
<dl class="section note"><dt>Note</dt><dd>The method will throw <code><a class="el" href="structdg_1_1_fail.html" title="Indicate failure to converge.">dg::Fail</a></code> if the desired accuracy is not reached within <code>max_iterations</code> You can unset this behaviour with the <code>set_throw_on_fail</code> member</dd></dl>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">MatrixType</td><td>Any class for which a specialization of <code><a class="el" href="structdg_1_1_tensor_traits.html" title="The vector traits.">TensorTraits</a></code> exists and defines a tensor_category derived from <code><a class="el" href="structdg_1_1_any_matrix_tag.html">AnyMatrixTag</a></code>. Furthermore, any functor/lambda type with signature <code> void operator()( const ContainerType0&amp;, ContainerType1&amp;) </code>. For example<ul>
<li><code>scalar</code> or <code>Container:</code> Scalars and containers act as diagonal matrices.</li>
<li><code> std::function&lt;void( const ContainerType0&amp;, ContainerType1&amp;)&gt; </code></li>
<li><code><a class="el" href="group__typedefs.html#gac2134505608b45616787fdb2f6eedc87" title="Host Matrix for derivatives.">dg::HMatrix</a></code> and <code><a class="el" href="group__typedefs.html#ga3d74638bbcf620f19e3728a07ef1706d">dg::IHMatrix</a></code> with <code><a class="el" href="group__typedefs.html#ga4fb8e78e7b043edfedb880523f0cd193" title="Host Vector.">dg::HVec</a></code> or <code>std::vector&lt;dg::HVec&gt;</code> </li>
<li><code><a class="el" href="group__typedefs.html#gafdf2ecb95cbc87a1544136d28d535f16" title="Device Matrix for derivatives.">dg::DMatrix</a></code> and <code><a class="el" href="group__typedefs.html#gaec4df2a8ab65260aed0efeb6f5d115e4">dg::IDMatrix</a></code> with <code><a class="el" href="group__typedefs.html#ga5bbe4ba51ef8ff8d506979d0beda25b8" title="Device Vector. The device can be an OpenMP parallelized cpu or a gpu. This depends on the value of th...">dg::DVec</a></code> or <code>std::vector&lt;dg::DVec&gt;</code> </li>
<li><code><a class="el" href="group__typedefs.html#gaff79c734c7916054c7dc24e6bc437161" title="MPI Host Matrix for derivatives.">dg::MHMatrix</a></code> with <code><a class="el" href="group__typedefs.html#gac127f65b65c035ebe413aee5abffd6f0" title="MPI Host Vector s.a. dg::HVec.">dg::MHVec</a></code> or <code>std::vector&lt;dg::MHVec&gt;</code> </li>
<li><code><a class="el" href="group__typedefs.html#gaad32454aa2aca3cbb93448d7b5daf005" title="MPI Device Matrix for derivatives.">dg::MDMatrix</a></code> with <code><a class="el" href="group__typedefs.html#ga1e23fb8b50d38d43beb4bf3689c20a55" title="MPI Device Vector s.a. dg::DVec.">dg::MDVec</a></code> or <code>std::vector&lt;dg::MDVec&gt;</code> </li>
</ul>
In case of <code><a class="el" href="structdg_1_1_self_made_matrix_tag.html" title="Indicates that the type has a member function with the same name and interface (up to the matrix itse...">SelfMadeMatrixTag</a></code> only those <code><a class="el" href="namespacedg_1_1blas2.html" title="BLAS Level 2 routines.">blas2</a></code> functions that have a corresponding member function in the Matrix class (e.g. <code> symv( const ContainerType0&amp;, ContainerType1&amp;); </code> ) can be called. If a <code>Container</code> has the <code><a class="el" href="structdg_1_1_recursive_vector_tag.html" title="This tag indicates composition/recursion.">RecursiveVectorTag</a></code>, then the matrix is applied to each of the elements unless the type has the <code><a class="el" href="structdg_1_1_self_made_matrix_tag.html" title="Indicates that the type has a member function with the same name and interface (up to the matrix itse...">SelfMadeMatrixTag</a></code> or is a Functor type.</td></tr>
    <tr><td class="paramname">ContainerType</td><td>Any class for which a specialization of <code><a class="el" href="structdg_1_1_tensor_traits.html" title="The vector traits.">TensorTraits</a></code> exists and which fulfills the requirements of the there defined data and execution policies derived from <code><a class="el" href="structdg_1_1_any_vector_tag.html" title="Vector Tag base class, indicates the basic Vector/container concept.">AnyVectorTag</a></code> and <code><a class="el" href="structdg_1_1_any_policy_tag.html" title="Execution Policy base class.">AnyPolicyTag</a></code>. Among others<ul>
<li><code> <a class="el" href="group__typedefs.html#ga4fb8e78e7b043edfedb880523f0cd193" title="Host Vector.">dg::HVec</a> (serial), <a class="el" href="group__typedefs.html#ga5bbe4ba51ef8ff8d506979d0beda25b8" title="Device Vector. The device can be an OpenMP parallelized cpu or a gpu. This depends on the value of th...">dg::DVec</a> (cuda / omp), <a class="el" href="group__typedefs.html#gac127f65b65c035ebe413aee5abffd6f0" title="MPI Host Vector s.a. dg::HVec.">dg::MHVec</a> (mpi + serial) or <a class="el" href="group__typedefs.html#ga1e23fb8b50d38d43beb4bf3689c20a55" title="MPI Device Vector s.a. dg::DVec.">dg::MDVec</a> (mpi + cuda / omp) </code></li>
<li><code> std::vector&lt;dg::DVec&gt; </code> (vector of shared device vectors), <code> std::array&lt;double, 4&gt; </code> (array of 4 doubles) or <code> std::map &lt; std::string, <a class="el" href="group__typedefs.html#ga5bbe4ba51ef8ff8d506979d0beda25b8" title="Device Vector. The device can be an OpenMP parallelized cpu or a gpu. This depends on the value of th...">dg::DVec</a>&gt; </code> ( a map of named vectors)</li>
<li><code> double (scalar)</code> and other primitive types ...</li>
</ul>
If there are several <code>ContainerTypes</code> in the argument list, then <code><a class="el" href="structdg_1_1_tensor_traits.html" title="The vector traits.">TensorTraits</a></code> must exist for all of them </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd>See <a class="el" href="group__blas.html#dispatch">The dg dispatch system</a> for a detailed explanation of our type dispatch system </dd></dl>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li><a class="el" href="andersonacc_8h_source.html">andersonacc.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.3-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacedg.html">dg</a></li><li class="navelem"><a class="el" href="structdg_1_1_anderson_acceleration.html">AndersonAcceleration</a></li>
    <li class="footer">Generated on Fri Jan 28 2022 17:46:21 for Discontinuous Galerkin Library by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
