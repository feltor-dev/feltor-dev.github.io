<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Discontinuous Galerkin Library: backend/mpi_grid.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?.../MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
    <!--My own title area-->
  <ul class="tablist"> 
      <!-- <li><a href="../../../index.html">/</a><li>-->
    <li><a href="../../dg/html/modules.html">dG</a></li>
    <li><a href="../../geometries/html/modules.html">geometry</a></li>
    <li><a href="../../file/html/namespacefile.html">file</a></li>
  </ul>
  <!--End My own title area-->
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Discontinuous Galerkin Library
   </div>
   <div id="projectbrief">Discontinuous Galerkin numerical methods and container free numerical algorithms</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('mpi__grid_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">mpi_grid.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="mpi__grid_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#pragma once</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;../enums.h&quot;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="grid_8h.html">grid.h</a>&quot;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacedg.html">dg</a></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;{</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html">   37</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structdg_1_1a_m_p_i_topology2d.html">aMPITopology2d</a></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#a5dc72392331fd90ed1ce9905bff862d3">   39</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structdg_1_1_m_p_i_tag.html">MPITag</a> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a5dc72392331fd90ed1ce9905bff862d3">memory_category</a>;</div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#add3eaef22b683eddc9db26210064d9a7">   40</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structdg_1_1_two_dimensional_tag.html">TwoDimensionalTag</a> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#add3eaef22b683eddc9db26210064d9a7">dimensionality</a>;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#afb32b0e071022f6cdfc19f6bc2665281">   47</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#afb32b0e071022f6cdfc19f6bc2665281">x0</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> g.<a class="code" href="structdg_1_1a_topology2d.html#a3b40c025394f50443d24b93035dfc51e">x0</a>();}</div><div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#a6f07eac8e87257c46dcbd6405faf319b">   53</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a6f07eac8e87257c46dcbd6405faf319b">x1</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> g.<a class="code" href="structdg_1_1a_topology2d.html#a9a6354d37c67bce0c514dee708a9f7fd">x1</a>(); }</div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#a37d48b883067b9a2dad905a4508ca06d">   59</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a37d48b883067b9a2dad905a4508ca06d">y0</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> g.<a class="code" href="structdg_1_1a_topology2d.html#a9013407c847ed51b70f9e73b5d42d77c">y0</a>();}</div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#a563be81b6ff55e594a2946d36ac16939">   65</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a563be81b6ff55e594a2946d36ac16939">y1</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> g.<a class="code" href="structdg_1_1a_topology2d.html#a2f5046ddad7754b4eafb0787b47373d9">y1</a>();}</div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#ab582e50841635d326233b60dea676586">   71</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#ab582e50841635d326233b60dea676586">lx</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> g.<a class="code" href="structdg_1_1a_topology2d.html#a142604ec8c0486a4600b2c62f8146fc6">lx</a>();}</div><div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#a82bb37573b4a2c4fc3932b8be0c00a25">   77</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a82bb37573b4a2c4fc3932b8be0c00a25">ly</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> g.<a class="code" href="structdg_1_1a_topology2d.html#a76abaddbe25813215241b0f50e774865">ly</a>();}</div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#a6756255527d688928ac3355df1a92c94">   83</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a6756255527d688928ac3355df1a92c94">hx</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> g.<a class="code" href="structdg_1_1a_topology2d.html#a13d71f34aa33577fb32177439822fbfd">hx</a>();}</div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#a9ed7ac5135e84649b9c15a9537cadfdb">   89</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a9ed7ac5135e84649b9c15a9537cadfdb">hy</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> g.<a class="code" href="structdg_1_1a_topology2d.html#ac6e0387e5428733add17d958f043033b">hy</a>();}</div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#aa55c7291d6354ad7f86348d94fa32450">   95</a></span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#aa55c7291d6354ad7f86348d94fa32450">n</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> g.<a class="code" href="structdg_1_1a_topology2d.html#a8acfe8e4f9f53bbc17f8b85d4dc5df9b">n</a>();}</div><div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#ae47851a2135233032b9996aaa3c5512d">  101</a></span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#ae47851a2135233032b9996aaa3c5512d">Nx</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> g.<a class="code" href="structdg_1_1a_topology2d.html#adb5dab9b977ab75682d745c8d932a3ac">Nx</a>();}</div><div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#a600f66398bd783c055a04d8b73116b24">  108</a></span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a600f66398bd783c055a04d8b73116b24">Ny</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> g.<a class="code" href="structdg_1_1a_topology2d.html#adc32942008d8c126ff323df4bd14fdbb">Ny</a>();}</div><div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#adc028300491ec43cb3d8d24d62c7e54b">  114</a></span>&#160;    <a class="code" href="group__creation.html#ga59440bdf436f2874b49aa52b670ed364">bc</a> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#adc028300491ec43cb3d8d24d62c7e54b">bcx</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> g.<a class="code" href="structdg_1_1a_topology2d.html#a2d62964fdcfb173dffba2784135a706c">bcx</a>();}</div><div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#a2743820bc1348550146db008fdd55e1f">  120</a></span>&#160;    <a class="code" href="group__creation.html#ga59440bdf436f2874b49aa52b670ed364">bc</a> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a2743820bc1348550146db008fdd55e1f">bcy</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> g.<a class="code" href="structdg_1_1a_topology2d.html#a5860583b29220ba90f597607b37856e9">bcy</a>();}</div><div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#acbdee1f83a4a29d6f5c1f9f5d3f36bf0">  126</a></span>&#160;    MPI_Comm <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#acbdee1f83a4a29d6f5c1f9f5d3f36bf0">communicator</a>()<span class="keyword"> const</span>{<span class="keywordflow">return</span> comm;}</div><div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#a78b58d3029b332b2be8fe8e7f152fd7a">  132</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="classdg_1_1_d_l_t.html">DLT&lt;double&gt;</a>&amp; <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a78b58d3029b332b2be8fe8e7f152fd7a">dlt</a>()<span class="keyword"> const</span>{<span class="keywordflow">return</span> g.<a class="code" href="structdg_1_1a_topology2d.html#a42f590d05c9cce424f5ff90f9f9f5c5c">dlt</a>();}</div><div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#aea3dd40d084245e88d5df87b48b29b28">  137</a></span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#aea3dd40d084245e88d5df87b48b29b28">size</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> g.<a class="code" href="structdg_1_1a_topology2d.html#a08dc0170234eb2a9b9fa36e24ee36cd3">size</a>();}</div><div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#added9e4b0ee0d4ffcc73e0d9ec685d2b">  142</a></span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#added9e4b0ee0d4ffcc73e0d9ec685d2b">local_size</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> l.<a class="code" href="structdg_1_1a_topology2d.html#a08dc0170234eb2a9b9fa36e24ee36cd3">size</a>();}</div><div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#a1168c699cc3373b6ac5622af08786733">  148</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a1168c699cc3373b6ac5622af08786733">display</a>( std::ostream&amp; os = std::cout)<span class="keyword"> const</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;GLOBAL GRID \n&quot;</span>;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        g.<a class="code" href="structdg_1_1a_topology2d.html#ad43f5d400ad3e2d4f3abdd0517576b84">display</a>();</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;LOCAL GRID \n&quot;</span>;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        l.<a class="code" href="structdg_1_1a_topology2d.html#ad43f5d400ad3e2d4f3abdd0517576b84">display</a>();</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a3ad794d304faf7e108a06876170d065d">pidOf</a>( <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y) <span class="keyword">const</span>;</div><div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#a5089d0560581c0d5f1b87c6c615469a4">  172</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a5089d0560581c0d5f1b87c6c615469a4">multiplyCellNumbers</a>( <span class="keywordtype">double</span> fx, <span class="keywordtype">double</span> fy){</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keyword">set</span>(g.<a class="code" href="structdg_1_1a_topology2d.html#a8acfe8e4f9f53bbc17f8b85d4dc5df9b">n</a>(), floor(fx*(<span class="keywordtype">double</span>)g.<a class="code" href="structdg_1_1a_topology2d.html#adb5dab9b977ab75682d745c8d932a3ac">Nx</a>()+0.5), floor(fy*(<span class="keywordtype">double</span>)g.<a class="code" href="structdg_1_1a_topology2d.html#adc32942008d8c126ff323df4bd14fdbb">Ny</a>()+0.5));</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    }</div><div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#af768612c2123266c195d7a6851fd5c14">  178</a></span>&#160;    <span class="keywordtype">void</span> <span class="keyword">set</span>( <span class="keywordtype">unsigned</span> new_n, <span class="keywordtype">unsigned</span> new_Nx, <span class="keywordtype">unsigned</span> new_Ny) {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        check_division( new_Nx, new_Ny, g.<a class="code" href="structdg_1_1a_topology2d.html#a2d62964fdcfb173dffba2784135a706c">bcx</a>(), g.<a class="code" href="structdg_1_1a_topology2d.html#a5860583b29220ba90f597607b37856e9">bcy</a>());</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">if</span>( new_n == g.<a class="code" href="structdg_1_1a_topology2d.html#a8acfe8e4f9f53bbc17f8b85d4dc5df9b">n</a>() &amp;&amp; new_Nx == g.<a class="code" href="structdg_1_1a_topology2d.html#adb5dab9b977ab75682d745c8d932a3ac">Nx</a>() &amp;&amp; new_Ny == g.<a class="code" href="structdg_1_1a_topology2d.html#adc32942008d8c126ff323df4bd14fdbb">Ny</a>()) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#ae4616e1cd8c87598aec7d8d0d95a2597">do_set</a>( new_n,new_Nx,new_Ny);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    }</div><div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#ab77f16bb1f6c1e496f54b65cb6d60eef">  191</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#ab77f16bb1f6c1e496f54b65cb6d60eef">local2globalIdx</a>( <span class="keywordtype">int</span> localIdx, <span class="keywordtype">int</span> PID, <span class="keywordtype">int</span>&amp; globalIdx)<span class="keyword">const</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <span class="keywordflow">if</span>( localIdx &lt; 0 || localIdx &gt;= (<span class="keywordtype">int</span>)<a class="code" href="structdg_1_1a_m_p_i_topology2d.html#aea3dd40d084245e88d5df87b48b29b28">size</a>()) <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordtype">int</span> coords[2];</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keywordflow">if</span>( MPI_Cart_coords( comm, PID, 2, coords) != MPI_SUCCESS)</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordtype">int</span> lIdx0 = localIdx %(l.<a class="code" href="structdg_1_1a_topology2d.html#a8acfe8e4f9f53bbc17f8b85d4dc5df9b">n</a>()*l.<a class="code" href="structdg_1_1a_topology2d.html#adb5dab9b977ab75682d745c8d932a3ac">Nx</a>());</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordtype">int</span> lIdx1 = localIdx /(l.<a class="code" href="structdg_1_1a_topology2d.html#a8acfe8e4f9f53bbc17f8b85d4dc5df9b">n</a>()*l.<a class="code" href="structdg_1_1a_topology2d.html#adb5dab9b977ab75682d745c8d932a3ac">Nx</a>());</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keywordtype">int</span> gIdx0 = coords[0]*l.<a class="code" href="structdg_1_1a_topology2d.html#a8acfe8e4f9f53bbc17f8b85d4dc5df9b">n</a>()*l.<a class="code" href="structdg_1_1a_topology2d.html#adb5dab9b977ab75682d745c8d932a3ac">Nx</a>()+lIdx0;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keywordtype">int</span> gIdx1 = coords[1]*l.<a class="code" href="structdg_1_1a_topology2d.html#a8acfe8e4f9f53bbc17f8b85d4dc5df9b">n</a>()*l.<a class="code" href="structdg_1_1a_topology2d.html#adc32942008d8c126ff323df4bd14fdbb">Ny</a>()+lIdx1;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        globalIdx = gIdx1*g.<a class="code" href="structdg_1_1a_topology2d.html#a8acfe8e4f9f53bbc17f8b85d4dc5df9b">n</a>()*g.<a class="code" href="structdg_1_1a_topology2d.html#adb5dab9b977ab75682d745c8d932a3ac">Nx</a>() + gIdx0;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    }</div><div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#a1581d96dca0aceefd24742056a0c982f">  212</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a1581d96dca0aceefd24742056a0c982f">global2localIdx</a>( <span class="keywordtype">int</span> globalIdx, <span class="keywordtype">int</span>&amp; localIdx, <span class="keywordtype">int</span>&amp; PID)<span class="keyword">const</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">if</span>( globalIdx &lt; 0 || globalIdx &gt;= (<span class="keywordtype">int</span>)g.<a class="code" href="structdg_1_1a_topology2d.html#a08dc0170234eb2a9b9fa36e24ee36cd3">size</a>()) <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordtype">int</span> coords[2];</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keywordtype">int</span> gIdx0 = globalIdx%(g.<a class="code" href="structdg_1_1a_topology2d.html#a8acfe8e4f9f53bbc17f8b85d4dc5df9b">n</a>()*g.<a class="code" href="structdg_1_1a_topology2d.html#adb5dab9b977ab75682d745c8d932a3ac">Nx</a>());</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordtype">int</span> gIdx1 = globalIdx/(g.<a class="code" href="structdg_1_1a_topology2d.html#a8acfe8e4f9f53bbc17f8b85d4dc5df9b">n</a>()*g.<a class="code" href="structdg_1_1a_topology2d.html#adb5dab9b977ab75682d745c8d932a3ac">Nx</a>());</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        coords[0] = gIdx0/(l.<a class="code" href="structdg_1_1a_topology2d.html#a8acfe8e4f9f53bbc17f8b85d4dc5df9b">n</a>()*l.<a class="code" href="structdg_1_1a_topology2d.html#adb5dab9b977ab75682d745c8d932a3ac">Nx</a>());</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        coords[1] = gIdx1/(l.<a class="code" href="structdg_1_1a_topology2d.html#a8acfe8e4f9f53bbc17f8b85d4dc5df9b">n</a>()*l.<a class="code" href="structdg_1_1a_topology2d.html#adc32942008d8c126ff323df4bd14fdbb">Ny</a>());</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordtype">int</span> lIdx0 = gIdx0%(l.<a class="code" href="structdg_1_1a_topology2d.html#a8acfe8e4f9f53bbc17f8b85d4dc5df9b">n</a>()*l.<a class="code" href="structdg_1_1a_topology2d.html#adb5dab9b977ab75682d745c8d932a3ac">Nx</a>());</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordtype">int</span> lIdx1 = gIdx1%(l.<a class="code" href="structdg_1_1a_topology2d.html#a8acfe8e4f9f53bbc17f8b85d4dc5df9b">n</a>()*l.<a class="code" href="structdg_1_1a_topology2d.html#adc32942008d8c126ff323df4bd14fdbb">Ny</a>());</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        localIdx = lIdx1*l.<a class="code" href="structdg_1_1a_topology2d.html#a8acfe8e4f9f53bbc17f8b85d4dc5df9b">n</a>()*l.<a class="code" href="structdg_1_1a_topology2d.html#adb5dab9b977ab75682d745c8d932a3ac">Nx</a>() + lIdx0;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordflow">if</span>( MPI_Cart_rank( comm, coords, &amp;PID) == MPI_SUCCESS ) </div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            std::cout&lt;&lt;<span class="stringliteral">&quot;Failed &quot;</span>&lt;&lt;PID&lt;&lt;<span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    }</div><div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#ac62b59dd5d174212a9636458453cc73f">  238</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="structdg_1_1_grid2d.html">Grid2d</a>&amp; <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#ac62b59dd5d174212a9636458453cc73f">local</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> l;}</div><div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#accc4614a7a9946d09221461979f5b8e0">  248</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="structdg_1_1_grid2d.html">Grid2d</a>&amp; <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#accc4614a7a9946d09221461979f5b8e0">global</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> g;}</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keyword">protected</span>:</div><div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#ab8f3ac8db800e03bd42011fd77af6890">  251</a></span>&#160;    <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#ab8f3ac8db800e03bd42011fd77af6890">~aMPITopology2d</a>(){}</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#a3cf33eca5e3d6ca607d1e49b3638974b">  258</a></span>&#160;    <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a3cf33eca5e3d6ca607d1e49b3638974b">aMPITopology2d</a>( <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#afb32b0e071022f6cdfc19f6bc2665281">x0</a>, <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a6f07eac8e87257c46dcbd6405faf319b">x1</a>, <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a37d48b883067b9a2dad905a4508ca06d">y0</a>, <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a563be81b6ff55e594a2946d36ac16939">y1</a>, <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#aa55c7291d6354ad7f86348d94fa32450">n</a>, <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#ae47851a2135233032b9996aaa3c5512d">Nx</a>, <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a600f66398bd783c055a04d8b73116b24">Ny</a>, <a class="code" href="group__creation.html#ga59440bdf436f2874b49aa52b670ed364">bc</a> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#adc028300491ec43cb3d8d24d62c7e54b">bcx</a>, <a class="code" href="group__creation.html#ga59440bdf436f2874b49aa52b670ed364">bc</a> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a2743820bc1348550146db008fdd55e1f">bcy</a>, MPI_Comm comm):</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        g( x0, x1, y0, y1, n, Nx, Ny, bcx, bcy), l(g), comm( comm)</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        update_local();</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        check_division( Nx, Ny, bcx, bcy);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div><div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#a12e826ed7763b1e97ba156f6164c9d00">  265</a></span>&#160;    <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a12e826ed7763b1e97ba156f6164c9d00">aMPITopology2d</a>(<span class="keyword">const</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html">aMPITopology2d</a>&amp; src):g(src.g),l(src.l),comm(src.comm){ }</div><div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology2d.html#a1e3e8416ca3dce951b2343c6cac22c90">  267</a></span>&#160;    <a class="code" href="structdg_1_1a_m_p_i_topology2d.html">aMPITopology2d</a>&amp; <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a1e3e8416ca3dce951b2343c6cac22c90">operator=</a>(<span class="keyword">const</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html">aMPITopology2d</a>&amp; src){</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        g = src.g; l = src.l; comm = src.comm;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    }</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#ae4616e1cd8c87598aec7d8d0d95a2597">do_set</a>( <span class="keywordtype">unsigned</span> new_n, <span class="keywordtype">unsigned</span> new_Nx, <span class="keywordtype">unsigned</span> new_Ny)=0;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keyword">private</span>:</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordtype">void</span> check_division( <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#ae47851a2135233032b9996aaa3c5512d">Nx</a>, <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a600f66398bd783c055a04d8b73116b24">Ny</a>, <a class="code" href="group__creation.html#ga59440bdf436f2874b49aa52b670ed364">bc</a> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#adc028300491ec43cb3d8d24d62c7e54b">bcx</a>, <a class="code" href="group__creation.html#ga59440bdf436f2874b49aa52b670ed364">bc</a> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a2743820bc1348550146db008fdd55e1f">bcy</a>)</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    {</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordtype">int</span> rank, dims[2], periods[2], coords[2];</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        MPI_Cart_get( comm, 2, dims, periods, coords);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        MPI_Comm_rank( comm, &amp;rank);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">if</span>( rank == 0)</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        {</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="keywordflow">if</span>(Nx%dims[0]!=0)</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                std::cerr &lt;&lt; <span class="stringliteral">&quot;Nx &quot;</span>&lt;&lt;Nx&lt;&lt;<span class="stringliteral">&quot; npx &quot;</span>&lt;&lt;dims[0]&lt;&lt;std::endl;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            assert( Nx%dims[0] == 0);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <span class="keywordflow">if</span>(Ny%dims[1]!=0)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                std::cerr &lt;&lt; <span class="stringliteral">&quot;Ny &quot;</span>&lt;&lt;Ny&lt;&lt;<span class="stringliteral">&quot; npy &quot;</span>&lt;&lt;dims[1]&lt;&lt;std::endl;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            assert( Ny%dims[1] == 0);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="keywordflow">if</span>( bcx == <a class="code" href="group__creation.html#gga59440bdf436f2874b49aa52b670ed364a948704f60491461974ce4fe6339778b3">dg::PER</a>) assert( periods[0] == <span class="keyword">true</span>);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <span class="keywordflow">else</span> assert( periods[0] == <span class="keyword">false</span>);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="keywordflow">if</span>( bcy == <a class="code" href="group__creation.html#gga59440bdf436f2874b49aa52b670ed364a948704f60491461974ce4fe6339778b3">dg::PER</a>) assert( periods[1] == <span class="keyword">true</span>);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <span class="keywordflow">else</span> assert( periods[1] == <span class="keyword">false</span>);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    }</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordtype">void</span> update_local(){</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keywordtype">int</span> dims[2], periods[2], coords[2];</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        MPI_Cart_get( comm, 2, dims, periods, coords);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#afb32b0e071022f6cdfc19f6bc2665281">x0</a> = g.<a class="code" href="structdg_1_1a_topology2d.html#a3b40c025394f50443d24b93035dfc51e">x0</a>() + g.<a class="code" href="structdg_1_1a_topology2d.html#a142604ec8c0486a4600b2c62f8146fc6">lx</a>()/(double)dims[0]*(<span class="keywordtype">double</span>)coords[0]; </div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a6f07eac8e87257c46dcbd6405faf319b">x1</a> = g.<a class="code" href="structdg_1_1a_topology2d.html#a3b40c025394f50443d24b93035dfc51e">x0</a>() + g.<a class="code" href="structdg_1_1a_topology2d.html#a142604ec8c0486a4600b2c62f8146fc6">lx</a>()/(double)dims[0]*(<span class="keywordtype">double</span>)(coords[0]+1); </div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keywordflow">if</span>( coords[0] == dims[0]-1) </div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            x1 = g.<a class="code" href="structdg_1_1a_topology2d.html#a9a6354d37c67bce0c514dee708a9f7fd">x1</a>();</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a37d48b883067b9a2dad905a4508ca06d">y0</a> = g.<a class="code" href="structdg_1_1a_topology2d.html#a9013407c847ed51b70f9e73b5d42d77c">y0</a>() + g.<a class="code" href="structdg_1_1a_topology2d.html#a76abaddbe25813215241b0f50e774865">ly</a>()/(double)dims[1]*(<span class="keywordtype">double</span>)coords[1]; </div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a563be81b6ff55e594a2946d36ac16939">y1</a> = g.<a class="code" href="structdg_1_1a_topology2d.html#a9013407c847ed51b70f9e73b5d42d77c">y0</a>() + g.<a class="code" href="structdg_1_1a_topology2d.html#a76abaddbe25813215241b0f50e774865">ly</a>()/(double)dims[1]*(<span class="keywordtype">double</span>)(coords[1]+1); </div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordflow">if</span>( coords[1] == dims[1]-1) </div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            y1 = g.<a class="code" href="structdg_1_1a_topology2d.html#a2f5046ddad7754b4eafb0787b47373d9">y1</a>();</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordtype">unsigned</span> Nx = g.<a class="code" href="structdg_1_1a_topology2d.html#adb5dab9b977ab75682d745c8d932a3ac">Nx</a>()/dims[0];</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordtype">unsigned</span> Ny = g.<a class="code" href="structdg_1_1a_topology2d.html#adc32942008d8c126ff323df4bd14fdbb">Ny</a>()/dims[1];</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        l = <a class="code" href="structdg_1_1_grid2d.html">Grid2d</a>(x0, x1, y0, y1, g.<a class="code" href="structdg_1_1a_topology2d.html#a8acfe8e4f9f53bbc17f8b85d4dc5df9b">n</a>(), <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#ae47851a2135233032b9996aaa3c5512d">Nx</a>, <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a600f66398bd783c055a04d8b73116b24">Ny</a>, g.<a class="code" href="structdg_1_1a_topology2d.html#a2d62964fdcfb173dffba2784135a706c">bcx</a>(), g.<a class="code" href="structdg_1_1a_topology2d.html#a5860583b29220ba90f597607b37856e9">bcy</a>());</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    }</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="structdg_1_1_grid2d.html">Grid2d</a> g, l; <span class="comment">//global and local grid</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    MPI_Comm comm; <span class="comment">//just an integer...</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;};</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html">  319</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structdg_1_1a_m_p_i_topology3d.html">aMPITopology3d</a></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;{</div><div class="line"><a name="l00321"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a7dd302b97be6418b70d6d3268ae498f3">  321</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structdg_1_1_m_p_i_tag.html">MPITag</a> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a7dd302b97be6418b70d6d3268ae498f3">memory_category</a>;</div><div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a9dcc823476daa7f1472b12759efba837">  322</a></span>&#160;    <span class="keyword">typedef</span> <a class="code" href="structdg_1_1_three_dimensional_tag.html">ThreeDimensionalTag</a> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a9dcc823476daa7f1472b12759efba837">dimensionality</a>;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a00cde0b1e4bad949ca2942c159fbaaa4">  329</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a00cde0b1e4bad949ca2942c159fbaaa4">x0</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> g.x0();}</div><div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a2ae109f81ca4f91e63ecd20d63f28a19">  335</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a2ae109f81ca4f91e63ecd20d63f28a19">x1</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> g.x1();}</div><div class="line"><a name="l00341"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#acd77a57371c8a2806e5e243a126a63bb">  341</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#acd77a57371c8a2806e5e243a126a63bb">y0</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> g.y0();}</div><div class="line"><a name="l00347"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#ae76296971b73308b2463960f74d39ccc">  347</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#ae76296971b73308b2463960f74d39ccc">y1</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> g.y1();}</div><div class="line"><a name="l00353"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#ade09cb61661db2a88e6c54645b204afc">  353</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#ade09cb61661db2a88e6c54645b204afc">z0</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> g.z0();}</div><div class="line"><a name="l00359"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a3cbe2e92a646139f4db30d3b0226c9b6">  359</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a3cbe2e92a646139f4db30d3b0226c9b6">z1</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> g.z1();}</div><div class="line"><a name="l00365"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a731a565d96b042fa52dee23965ce7692">  365</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a731a565d96b042fa52dee23965ce7692">lx</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> g.lx();}</div><div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#aca8c966478d6d248316f6b88c259eb9c">  371</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#aca8c966478d6d248316f6b88c259eb9c">ly</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> g.ly();}</div><div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a349d987c1a9ad6756d7c35dbf3ab31d3">  377</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a349d987c1a9ad6756d7c35dbf3ab31d3">lz</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> g.lz();}</div><div class="line"><a name="l00383"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a26dfa70dc4ecacd961741506187b6733">  383</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a26dfa70dc4ecacd961741506187b6733">hx</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> g.hx();}</div><div class="line"><a name="l00389"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a23bcf1fed27b298056d64c70ec5e0cb9">  389</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a23bcf1fed27b298056d64c70ec5e0cb9">hy</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> g.hy();}</div><div class="line"><a name="l00395"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#adee8503742abba153b172d91c0a4cc1e">  395</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#adee8503742abba153b172d91c0a4cc1e">hz</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> g.hz();}</div><div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#aa1112ace51cdf7c72979a67bf62748e1">  401</a></span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#aa1112ace51cdf7c72979a67bf62748e1">n</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> g.n();}</div><div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#aa0d345c043bb5126ccf2f1662e8e1f81">  408</a></span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#aa0d345c043bb5126ccf2f1662e8e1f81">Nx</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> g.Nx();}</div><div class="line"><a name="l00415"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#ac77bafcdcd9cb267c46168f66590cd3c">  415</a></span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#ac77bafcdcd9cb267c46168f66590cd3c">Ny</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> g.Ny();}</div><div class="line"><a name="l00422"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#ad1c83722df957f6fa733b29fc3afe769">  422</a></span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#ad1c83722df957f6fa733b29fc3afe769">Nz</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> g.Nz();}</div><div class="line"><a name="l00428"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#aaa799c1da21b8d02c965ddc691660ab0">  428</a></span>&#160;    <a class="code" href="group__creation.html#ga59440bdf436f2874b49aa52b670ed364">bc</a> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#aaa799c1da21b8d02c965ddc691660ab0">bcx</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> g.bcx();}</div><div class="line"><a name="l00434"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a2099d0ee39f50542d521ed520fd04172">  434</a></span>&#160;    <a class="code" href="group__creation.html#ga59440bdf436f2874b49aa52b670ed364">bc</a> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a2099d0ee39f50542d521ed520fd04172">bcy</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> g.bcy();}</div><div class="line"><a name="l00440"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a4844168330e79f6083175be424640c9b">  440</a></span>&#160;    <a class="code" href="group__creation.html#ga59440bdf436f2874b49aa52b670ed364">bc</a> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a4844168330e79f6083175be424640c9b">bcz</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> g.bcz();}</div><div class="line"><a name="l00445"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a2e02320a66d1a411a66f3d2b97623f88">  445</a></span>&#160;    MPI_Comm <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a2e02320a66d1a411a66f3d2b97623f88">communicator</a>()<span class="keyword"> const</span>{<span class="keywordflow">return</span> comm;}</div><div class="line"><a name="l00450"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#acb9c894885849f0a246d7292f76634c7">  450</a></span>&#160;    MPI_Comm <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#acb9c894885849f0a246d7292f76634c7">get_perp_comm</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> planeComm;}</div><div class="line"><a name="l00456"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a40f53efc9fed790cf62235855ba6da41">  456</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="classdg_1_1_d_l_t.html">DLT&lt;double&gt;</a>&amp; <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a40f53efc9fed790cf62235855ba6da41">dlt</a>()<span class="keyword"> const</span>{<span class="keywordflow">return</span> g.dlt();}</div><div class="line"><a name="l00461"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#aa432bebd8a88e4ae68c14be50c63f3bd">  461</a></span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#aa432bebd8a88e4ae68c14be50c63f3bd">size</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> g.size();}</div><div class="line"><a name="l00466"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a7f3c70959bc51da96292fdd3fff219ec">  466</a></span>&#160;    <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a7f3c70959bc51da96292fdd3fff219ec">local_size</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> l.size();}</div><div class="line"><a name="l00472"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#af5e4b7a823b5a7acd457ba27c4e95024">  472</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#af5e4b7a823b5a7acd457ba27c4e95024">display</a>( std::ostream&amp; os = std::cout)<span class="keyword"> const</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;GLOBAL GRID \n&quot;</span>;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        g.display();</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;LOCAL GRID \n&quot;</span>;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        l.display();</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    }</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a3ad794d304faf7e108a06876170d065d">pidOf</a>( <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z) <span class="keyword">const</span>;</div><div class="line"><a name="l00490"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a7f738622683822e17203a3914353b1ec">  490</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a7f738622683822e17203a3914353b1ec">multiplyCellNumbers</a>( <span class="keywordtype">double</span> fx, <span class="keywordtype">double</span> fy){</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="keyword">set</span>(g.n(), round(fx*(<span class="keywordtype">double</span>)g.Nx()), round(fy*(<span class="keywordtype">double</span>)g.Ny()), g.Nz());</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    }</div><div class="line"><a name="l00496"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a02c66391da13b72da13c0bbe3dd86657">  496</a></span>&#160;    <span class="keywordtype">void</span> <span class="keyword">set</span>( <span class="keywordtype">unsigned</span> new_n, <span class="keywordtype">unsigned</span> new_Nx, <span class="keywordtype">unsigned</span> new_Ny, <span class="keywordtype">unsigned</span> new_Nz) {</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        check_division( new_Nx,new_Ny,new_Nz,g.bcx(),g.bcy(),g.bcz());</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keywordflow">if</span>( new_n == g.n() &amp;&amp; new_Nx == g.Nx() &amp;&amp; new_Ny == g.Ny() &amp;&amp; new_Nz == g.Nz()) <span class="keywordflow">return</span>;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#ae4616e1cd8c87598aec7d8d0d95a2597">do_set</a>(new_n,new_Nx,new_Ny,new_Nz);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    }</div><div class="line"><a name="l00502"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a66be3a40e31352a339f61df03b46a69a">  502</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a66be3a40e31352a339f61df03b46a69a">local2globalIdx</a>( <span class="keywordtype">int</span> localIdx, <span class="keywordtype">int</span> PID, <span class="keywordtype">int</span>&amp; globalIdx)<span class="keyword">const</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keywordflow">if</span>( localIdx &lt; 0 || localIdx &gt;= (<span class="keywordtype">int</span>)<a class="code" href="structdg_1_1a_m_p_i_topology2d.html#aea3dd40d084245e88d5df87b48b29b28">size</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keywordtype">int</span> coords[3];</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordflow">if</span>( MPI_Cart_coords( comm, PID, 3, coords) != MPI_SUCCESS)</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="keywordtype">int</span> lIdx0 = localIdx %(l.n()*l.Nx());</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keywordtype">int</span> lIdx1 = (localIdx /(l.n()*l.Nx())) % (l.n()*l.Ny());</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="keywordtype">int</span> lIdx2 = localIdx / (l.n()*l.n()*l.Nx()*l.Ny());</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="keywordtype">int</span> gIdx0 = coords[0]*l.n()*l.Nx()+lIdx0;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordtype">int</span> gIdx1 = coords[1]*l.n()*l.Ny()+lIdx1;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="keywordtype">int</span> gIdx2 = coords[2]*l.Nz()  + lIdx2;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        globalIdx = (gIdx2*g.n()*g.Ny() + gIdx1)*g.n()*g.Nx() + gIdx0;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    }</div><div class="line"><a name="l00518"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a92be21ea57b8be612301124cf15aad2d">  518</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a92be21ea57b8be612301124cf15aad2d">global2localIdx</a>( <span class="keywordtype">int</span> globalIdx, <span class="keywordtype">int</span>&amp; localIdx, <span class="keywordtype">int</span>&amp; PID)<span class="keyword">const</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keywordflow">if</span>( globalIdx &lt; 0 || globalIdx &gt;= (<span class="keywordtype">int</span>)g.size()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="keywordtype">int</span> coords[3];</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordtype">int</span> gIdx0 = globalIdx%(g.n()*g.Nx());</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="keywordtype">int</span> gIdx1 = (globalIdx/(g.n()*g.Nx())) % (g.n()*g.Ny());</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="keywordtype">int</span> gIdx2 = globalIdx/(g.n()*g.n()*g.Nx()*g.Ny());</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        coords[0] = gIdx0/(l.n()*l.Nx());</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        coords[1] = gIdx1/(l.n()*l.Ny());</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        coords[2] = gIdx2/l.Nz();</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="keywordtype">int</span> lIdx0 = gIdx0%(l.n()*l.Nx());</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="keywordtype">int</span> lIdx1 = gIdx1%(l.n()*l.Ny());</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="keywordtype">int</span> lIdx2 = gIdx2%l.Nz();</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        localIdx = (lIdx2*l.n()*l.Ny() + lIdx1)*l.n()*l.Nx() + lIdx0;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="keywordflow">if</span>( MPI_Cart_rank( comm, coords, &amp;PID) == MPI_SUCCESS ) </div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    }</div><div class="line"><a name="l00538"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#ac28f9801458d0789776ee59541849359">  538</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="structdg_1_1_grid3d.html">Grid3d</a>&amp; <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#ac28f9801458d0789776ee59541849359">local</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> l;}</div><div class="line"><a name="l00540"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a1775452b98ced34501f03ccddd7701d1">  540</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="structdg_1_1_grid3d.html">Grid3d</a>&amp; <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a1775452b98ced34501f03ccddd7701d1">global</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> g;}</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keyword">protected</span>:</div><div class="line"><a name="l00543"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a23fd057296e9999845509c74aa5ebd5b">  543</a></span>&#160;    <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a23fd057296e9999845509c74aa5ebd5b">~aMPITopology3d</a>(){}</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div><div class="line"><a name="l00548"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a569e10cbdc7a0b799cb5e4e08bd07287">  548</a></span>&#160;    <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a569e10cbdc7a0b799cb5e4e08bd07287">aMPITopology3d</a>( <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#afb32b0e071022f6cdfc19f6bc2665281">x0</a>, <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a6f07eac8e87257c46dcbd6405faf319b">x1</a>, <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a37d48b883067b9a2dad905a4508ca06d">y0</a>, <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a563be81b6ff55e594a2946d36ac16939">y1</a>, <span class="keywordtype">double</span> z0, <span class="keywordtype">double</span> z1, <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#aa55c7291d6354ad7f86348d94fa32450">n</a>, <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#ae47851a2135233032b9996aaa3c5512d">Nx</a>, <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a600f66398bd783c055a04d8b73116b24">Ny</a>, <span class="keywordtype">unsigned</span> Nz, <a class="code" href="group__creation.html#ga59440bdf436f2874b49aa52b670ed364">bc</a> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#adc028300491ec43cb3d8d24d62c7e54b">bcx</a>, <a class="code" href="group__creation.html#ga59440bdf436f2874b49aa52b670ed364">bc</a> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a2743820bc1348550146db008fdd55e1f">bcy</a>, <a class="code" href="group__creation.html#ga59440bdf436f2874b49aa52b670ed364">bc</a> bcz, MPI_Comm comm):</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        g( x0, x1, y0, y1, z0, z1, n, Nx, Ny, Nz, bcx, bcy, bcz), l(g), comm( comm)</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    {</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        update_local();</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        check_division( Nx, Ny, Nz, bcx, bcy, bcz);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="keywordtype">int</span> remain_dims[] = {<span class="keyword">true</span>,<span class="keyword">true</span>,<span class="keyword">false</span>}; <span class="comment">//true true false</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        MPI_Cart_sub( comm, remain_dims, &amp;planeComm);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    }</div><div class="line"><a name="l00558"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a76ca4d836a3f6bbca5b5112f4d4b58cc">  558</a></span>&#160;    <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a76ca4d836a3f6bbca5b5112f4d4b58cc">aMPITopology3d</a>(<span class="keyword">const</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html">aMPITopology3d</a>&amp; src):g(src.g),l(src.l),comm(src.comm),planeComm(src.planeComm){ }</div><div class="line"><a name="l00561"></a><span class="lineno"><a class="line" href="structdg_1_1a_m_p_i_topology3d.html#a0a28e58716749d39fc4a477e7236502c">  561</a></span>&#160;    <a class="code" href="structdg_1_1a_m_p_i_topology3d.html">aMPITopology3d</a>&amp; <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a0a28e58716749d39fc4a477e7236502c">operator=</a>(<span class="keyword">const</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html">aMPITopology3d</a>&amp; src){</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        g = src.g; l = src.l; comm = src.comm; planeComm = src.planeComm;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    }</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#ae4616e1cd8c87598aec7d8d0d95a2597">do_set</a>( <span class="keywordtype">unsigned</span> new_n, <span class="keywordtype">unsigned</span> new_Nx, <span class="keywordtype">unsigned</span> new_Ny, <span class="keywordtype">unsigned</span> new_Nz)=0; </div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keyword">private</span>:</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordtype">void</span> check_division( <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#ae47851a2135233032b9996aaa3c5512d">Nx</a>, <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a600f66398bd783c055a04d8b73116b24">Ny</a>, <span class="keywordtype">unsigned</span> Nz, <a class="code" href="group__creation.html#ga59440bdf436f2874b49aa52b670ed364">bc</a> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#adc028300491ec43cb3d8d24d62c7e54b">bcx</a>, <a class="code" href="group__creation.html#ga59440bdf436f2874b49aa52b670ed364">bc</a> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a2743820bc1348550146db008fdd55e1f">bcy</a>, <a class="code" href="group__creation.html#ga59440bdf436f2874b49aa52b670ed364">bc</a> bcz)</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    {</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="keywordtype">int</span> rank, dims[3], periods[3], coords[3];</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        MPI_Cart_get( comm, 3, dims, periods, coords);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        MPI_Comm_rank( comm, &amp;rank);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keywordflow">if</span>( rank == 0)</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        {</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            <span class="keywordflow">if</span>(!(Nx%dims[0]==0))</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                std::cerr &lt;&lt; <span class="stringliteral">&quot;Nx &quot;</span>&lt;&lt;Nx&lt;&lt;<span class="stringliteral">&quot; npx &quot;</span>&lt;&lt;dims[0]&lt;&lt;std::endl;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            assert( Nx%dims[0] == 0);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            <span class="keywordflow">if</span>( !(Ny%dims[1]==0))</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                std::cerr &lt;&lt; <span class="stringliteral">&quot;Ny &quot;</span>&lt;&lt;Ny&lt;&lt;<span class="stringliteral">&quot; npy &quot;</span>&lt;&lt;dims[1]&lt;&lt;std::endl;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            assert( Ny%dims[1] == 0);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            <span class="keywordflow">if</span>( !(Nz%dims[2]==0))</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                std::cerr &lt;&lt; <span class="stringliteral">&quot;Nz &quot;</span>&lt;&lt;Nz&lt;&lt;<span class="stringliteral">&quot; npz &quot;</span>&lt;&lt;dims[2]&lt;&lt;std::endl;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            assert( Nz%dims[2] == 0);</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            <span class="keywordflow">if</span>( bcx == <a class="code" href="group__creation.html#gga59440bdf436f2874b49aa52b670ed364a948704f60491461974ce4fe6339778b3">dg::PER</a>) assert( periods[0] == <span class="keyword">true</span>);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            <span class="keywordflow">else</span> assert( periods[0] == <span class="keyword">false</span>);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            <span class="keywordflow">if</span>( bcy == <a class="code" href="group__creation.html#gga59440bdf436f2874b49aa52b670ed364a948704f60491461974ce4fe6339778b3">dg::PER</a>) assert( periods[1] == <span class="keyword">true</span>);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            <span class="keywordflow">else</span> assert( periods[1] == <span class="keyword">false</span>);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <span class="keywordflow">if</span>( bcz == <a class="code" href="group__creation.html#gga59440bdf436f2874b49aa52b670ed364a948704f60491461974ce4fe6339778b3">dg::PER</a>) assert( periods[2] == <span class="keyword">true</span>);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            <span class="keywordflow">else</span> assert( periods[2] == <span class="keyword">false</span>);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        }</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    }</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordtype">void</span> update_local(){</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="keywordtype">int</span> dims[3], periods[3], coords[3];</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        MPI_Cart_get( comm, 3, dims, periods, coords);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#afb32b0e071022f6cdfc19f6bc2665281">x0</a> = g.x0() + g.lx()/(double)dims[0]*(<span class="keywordtype">double</span>)coords[0]; </div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a6f07eac8e87257c46dcbd6405faf319b">x1</a> = g.x0() + g.lx()/(double)dims[0]*(<span class="keywordtype">double</span>)(coords[0]+1); </div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="keywordflow">if</span>( coords[0] == dims[0]-1) </div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            x1 = g.x1();</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a37d48b883067b9a2dad905a4508ca06d">y0</a> = g.y0() + g.ly()/(double)dims[1]*(<span class="keywordtype">double</span>)coords[1]; </div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a563be81b6ff55e594a2946d36ac16939">y1</a> = g.y0() + g.ly()/(double)dims[1]*(<span class="keywordtype">double</span>)(coords[1]+1); </div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="keywordflow">if</span>( coords[1] == dims[1]-1) </div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            y1 = g.y1();</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <span class="keywordtype">double</span> z0 = g.z0() + g.lz()/(double)dims[2]*(<span class="keywordtype">double</span>)coords[2]; </div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="keywordtype">double</span> z1 = g.z0() + g.lz()/(double)dims[2]*(<span class="keywordtype">double</span>)(coords[2]+1); </div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keywordflow">if</span>( coords[2] == dims[2]-1) </div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            z1 = g.z1();</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordtype">unsigned</span> Nx = g.Nx()/dims[0];</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="keywordtype">unsigned</span> Ny = g.Ny()/dims[1];</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="keywordtype">unsigned</span> Nz = g.Nz()/dims[2];</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        </div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        l = <a class="code" href="structdg_1_1_grid3d.html">Grid3d</a>(x0, x1, y0, y1, z0, z1, g.n(), <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#ae47851a2135233032b9996aaa3c5512d">Nx</a>, <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a600f66398bd783c055a04d8b73116b24">Ny</a>, Nz, g.bcx(), g.bcy(), g.bcz());</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    }</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <a class="code" href="structdg_1_1_grid3d.html">Grid3d</a> g, l; <span class="comment">//global grid</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    MPI_Comm comm, planeComm; <span class="comment">//just an integer...</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;};</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="keywordtype">int</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a3ad794d304faf7e108a06876170d065d">aMPITopology2d::pidOf</a>( <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y)<span class="keyword"> const</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keywordtype">int</span> dims[2], periods[2], coords[2];</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    MPI_Cart_get( comm, 2, dims, periods, coords);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    coords[0] = (unsigned)floor( (x-g.x0())/g.lx()*(double)dims[0] );</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    coords[1] = (unsigned)floor( (y-g.y0())/g.ly()*(double)dims[1] );</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="comment">//if point lies on or over boundary of last cell shift into current cell (not so good for periodic boundaries)</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    coords[0]=(coords[0]==dims[0]) ? coords[0]-1 :coords[0];</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    coords[1]=(coords[1]==dims[1]) ? coords[1]-1 :coords[1];</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordtype">int</span> rank;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordflow">if</span>( MPI_Cart_rank( comm, coords, &amp;rank) == MPI_SUCCESS ) </div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="keywordflow">return</span> rank;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;}</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="keywordtype">int</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a8b0f6bf367ad17a6330d552ca87eba95">aMPITopology3d::pidOf</a>( <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z)<span class="keyword"> const</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordtype">int</span> dims[3], periods[3], coords[3];</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    MPI_Cart_get( comm, 3, dims, periods, coords);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    coords[0] = (unsigned)floor( (x-g.x0())/g.lx()*(double)dims[0] );</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    coords[1] = (unsigned)floor( (y-g.y0())/g.ly()*(double)dims[1] );</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    coords[2] = (unsigned)floor( (z-g.z0())/g.lz()*(double)dims[2] );</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="comment">//if point lies on or over boundary of last cell shift into current cell (not so good for periodic boundaries)</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    coords[0]=(coords[0]==dims[0]) ? coords[0]-1 :coords[0];</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    coords[1]=(coords[1]==dims[1]) ? coords[1]-1 :coords[1];</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    coords[2]=(coords[2]==dims[2]) ? coords[2]-1 :coords[2];</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keywordtype">int</span> rank;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keywordflow">if</span>( MPI_Cart_rank( comm, coords, &amp;rank) == MPI_SUCCESS ) </div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <span class="keywordflow">return</span> rank;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;}</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="keywordtype">void</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#ae4616e1cd8c87598aec7d8d0d95a2597">aMPITopology2d::do_set</a>( <span class="keywordtype">unsigned</span> new_n, <span class="keywordtype">unsigned</span> new_Nx, <span class="keywordtype">unsigned</span> new_Ny) {</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    g.set(new_n,new_Nx,new_Ny);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    update_local();</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;}</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="keywordtype">void</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a28958c5bb8b2ad63de0f4fdbc2849282">aMPITopology3d::do_set</a>( <span class="keywordtype">unsigned</span> new_n, <span class="keywordtype">unsigned</span> new_Nx, <span class="keywordtype">unsigned</span> new_Ny, <span class="keywordtype">unsigned</span> new_Nz) {</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    g.set(new_n,new_Nx,new_Ny,new_Nz);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    update_local();</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;}</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="keyword">struct </span><a class="code" href="structdg_1_1_m_p_i_grid2d.html">MPIGrid2d</a>: <span class="keyword">public</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html">aMPITopology2d</a></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;{</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <a class="code" href="structdg_1_1_m_p_i_grid2d.html">MPIGrid2d</a>( <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#afb32b0e071022f6cdfc19f6bc2665281">x0</a>, <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a6f07eac8e87257c46dcbd6405faf319b">x1</a>, <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a37d48b883067b9a2dad905a4508ca06d">y0</a>, <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a563be81b6ff55e594a2946d36ac16939">y1</a>, <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#aa55c7291d6354ad7f86348d94fa32450">n</a>, <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#ae47851a2135233032b9996aaa3c5512d">Nx</a>, <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a600f66398bd783c055a04d8b73116b24">Ny</a>, MPI_Comm comm):</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a3cf33eca5e3d6ca607d1e49b3638974b">aMPITopology2d</a>( x0,x1,y0,y1,n,Nx,Ny,<a class="code" href="group__creation.html#gga59440bdf436f2874b49aa52b670ed364a948704f60491461974ce4fe6339778b3">dg::PER</a>,<a class="code" href="group__creation.html#gga59440bdf436f2874b49aa52b670ed364a948704f60491461974ce4fe6339778b3">dg::PER</a>,comm)</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    { }</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <a class="code" href="structdg_1_1_m_p_i_grid2d.html">MPIGrid2d</a>( <span class="keywordtype">double</span> x0, <span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> y0, <span class="keywordtype">double</span> y1, <span class="keywordtype">unsigned</span> n, <span class="keywordtype">unsigned</span> Nx, <span class="keywordtype">unsigned</span> Ny, <a class="code" href="group__creation.html#ga59440bdf436f2874b49aa52b670ed364">bc</a> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#adc028300491ec43cb3d8d24d62c7e54b">bcx</a>, <a class="code" href="group__creation.html#ga59440bdf436f2874b49aa52b670ed364">bc</a> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a2743820bc1348550146db008fdd55e1f">bcy</a>, MPI_Comm comm):</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a3cf33eca5e3d6ca607d1e49b3638974b">aMPITopology2d</a>( x0,x1,y0,y1,n,Nx,Ny,bcx,bcy,comm)</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    { }</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keyword">explicit</span> <a class="code" href="structdg_1_1_m_p_i_grid2d.html">MPIGrid2d</a>( <span class="keyword">const</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html">aMPITopology2d</a>&amp; src): <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a3cf33eca5e3d6ca607d1e49b3638974b">aMPITopology2d</a>(src){}</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keyword">private</span>:</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#ae4616e1cd8c87598aec7d8d0d95a2597">do_set</a>( <span class="keywordtype">unsigned</span> new_n, <span class="keywordtype">unsigned</span> new_Nx, <span class="keywordtype">unsigned</span> new_Ny){</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#ae4616e1cd8c87598aec7d8d0d95a2597">aMPITopology2d::do_set</a>(new_n,new_Nx,new_Ny);</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    }</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;};</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="keyword">struct </span><a class="code" href="structdg_1_1_m_p_i_grid3d.html">MPIGrid3d</a> : <span class="keyword">public</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html">aMPITopology3d</a></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;{</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <a class="code" href="structdg_1_1_m_p_i_grid3d.html">MPIGrid3d</a>( <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#afb32b0e071022f6cdfc19f6bc2665281">x0</a>, <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a6f07eac8e87257c46dcbd6405faf319b">x1</a>, <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a37d48b883067b9a2dad905a4508ca06d">y0</a>, <span class="keywordtype">double</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a563be81b6ff55e594a2946d36ac16939">y1</a>, <span class="keywordtype">double</span> z0, <span class="keywordtype">double</span> z1, <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#aa55c7291d6354ad7f86348d94fa32450">n</a>, <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#ae47851a2135233032b9996aaa3c5512d">Nx</a>, <span class="keywordtype">unsigned</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a600f66398bd783c055a04d8b73116b24">Ny</a>, <span class="keywordtype">unsigned</span> Nz, MPI_Comm comm):</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <a class="code" href="structdg_1_1a_m_p_i_topology3d.html">aMPITopology3d</a>( x0, x1, y0, y1, z0, z1, n, Nx, Ny, Nz, <a class="code" href="group__creation.html#gga59440bdf436f2874b49aa52b670ed364a948704f60491461974ce4fe6339778b3">dg::PER</a>, <a class="code" href="group__creation.html#gga59440bdf436f2874b49aa52b670ed364a948704f60491461974ce4fe6339778b3">dg::PER</a>, <a class="code" href="group__creation.html#gga59440bdf436f2874b49aa52b670ed364a948704f60491461974ce4fe6339778b3">dg::PER</a>,comm )</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    { }</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <a class="code" href="structdg_1_1_m_p_i_grid3d.html">MPIGrid3d</a>( <span class="keywordtype">double</span> x0, <span class="keywordtype">double</span> x1, <span class="keywordtype">double</span> y0, <span class="keywordtype">double</span> y1, <span class="keywordtype">double</span> z0, <span class="keywordtype">double</span> z1, <span class="keywordtype">unsigned</span> n, <span class="keywordtype">unsigned</span> Nx, <span class="keywordtype">unsigned</span> Ny, <span class="keywordtype">unsigned</span> Nz, <a class="code" href="group__creation.html#ga59440bdf436f2874b49aa52b670ed364">bc</a> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#adc028300491ec43cb3d8d24d62c7e54b">bcx</a>, <a class="code" href="group__creation.html#ga59440bdf436f2874b49aa52b670ed364">bc</a> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#a2743820bc1348550146db008fdd55e1f">bcy</a>, <a class="code" href="group__creation.html#ga59440bdf436f2874b49aa52b670ed364">bc</a> bcz, MPI_Comm comm):</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <a class="code" href="structdg_1_1a_m_p_i_topology3d.html">aMPITopology3d</a>( x0, x1, y0, y1, z0, z1, n, Nx, Ny, Nz, bcx, bcy, bcz, comm)</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    { }</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keyword">explicit</span> <a class="code" href="structdg_1_1_m_p_i_grid3d.html">MPIGrid3d</a>( <span class="keyword">const</span> <a class="code" href="structdg_1_1a_m_p_i_topology3d.html">aMPITopology3d</a>&amp; src): <a class="code" href="structdg_1_1a_m_p_i_topology3d.html">aMPITopology3d</a>(src){ }</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keyword">private</span>:</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="structdg_1_1a_m_p_i_topology2d.html#ae4616e1cd8c87598aec7d8d0d95a2597">do_set</a>( <span class="keywordtype">unsigned</span> new_n, <span class="keywordtype">unsigned</span> new_Nx, <span class="keywordtype">unsigned</span> new_Ny, <span class="keywordtype">unsigned</span> new_Nz){</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <a class="code" href="structdg_1_1a_m_p_i_topology3d.html#a28958c5bb8b2ad63de0f4fdbc2849282">aMPITopology3d::do_set</a>(new_n,new_Nx,new_Ny,new_Nz);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    }</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;};</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;}<span class="comment">//namespace dg</span></div><div class="ttc" id="classdg_1_1_d_l_t_html"><div class="ttname"><a href="classdg_1_1_d_l_t.html">dg::DLT&lt; double &gt;</a></div></div>
<div class="ttc" id="structdg_1_1a_topology2d_html_a5860583b29220ba90f597607b37856e9"><div class="ttname"><a href="structdg_1_1a_topology2d.html#a5860583b29220ba90f597607b37856e9">dg::aTopology2d::bcy</a></div><div class="ttdeci">bc bcy() const </div><div class="ttdoc">boundary conditions in y </div><div class="ttdef"><b>Definition:</b> grid.h:317</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a569e10cbdc7a0b799cb5e4e08bd07287"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a569e10cbdc7a0b799cb5e4e08bd07287">dg::aMPITopology3d::aMPITopology3d</a></div><div class="ttdeci">aMPITopology3d(double x0, double x1, double y0, double y1, double z0, double z1, unsigned n, unsigned Nx, unsigned Ny, unsigned Nz, bc bcx, bc bcy, bc bcz, MPI_Comm comm)</div><div class="ttdoc">Construct a 3D grid. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:548</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_aa0d345c043bb5126ccf2f1662e8e1f81"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#aa0d345c043bb5126ccf2f1662e8e1f81">dg::aMPITopology3d::Nx</a></div><div class="ttdeci">unsigned Nx() const </div><div class="ttdoc">Return the global number of cells. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:408</div></div>
<div class="ttc" id="structdg_1_1_m_p_i_grid2d_html"><div class="ttname"><a href="structdg_1_1_m_p_i_grid2d.html">dg::MPIGrid2d</a></div><div class="ttdoc">The simplest implementation of aMPITopology2d. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:664</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_ad1c83722df957f6fa733b29fc3afe769"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#ad1c83722df957f6fa733b29fc3afe769">dg::aMPITopology3d::Nz</a></div><div class="ttdeci">unsigned Nz() const </div><div class="ttdoc">Return the global number of cells. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:422</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a8b0f6bf367ad17a6330d552ca87eba95"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a8b0f6bf367ad17a6330d552ca87eba95">dg::aMPITopology3d::pidOf</a></div><div class="ttdeci">int pidOf(double x, double y, double z) const </div><div class="ttdoc">Returns the pid of the process that holds the local grid surrounding the given point. </div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_accc4614a7a9946d09221461979f5b8e0"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#accc4614a7a9946d09221461979f5b8e0">dg::aMPITopology2d::global</a></div><div class="ttdeci">const Grid2d &amp; global() const </div><div class="ttdoc">Return the global non-MPI grid. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:248</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_aca8c966478d6d248316f6b88c259eb9c"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#aca8c966478d6d248316f6b88c259eb9c">dg::aMPITopology3d::ly</a></div><div class="ttdeci">double ly() const </div><div class="ttdoc">Return global ly. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:371</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_a1168c699cc3373b6ac5622af08786733"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#a1168c699cc3373b6ac5622af08786733">dg::aMPITopology2d::display</a></div><div class="ttdeci">void display(std::ostream &amp;os=std::cout) const </div><div class="ttdoc">Display global and local grid. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:148</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a66be3a40e31352a339f61df03b46a69a"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a66be3a40e31352a339f61df03b46a69a">dg::aMPITopology3d::local2globalIdx</a></div><div class="ttdeci">bool local2globalIdx(int localIdx, int PID, int &amp;globalIdx) const </div><div class="ttdoc">Map a local index plus the PID to a global vector index. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:502</div></div>
<div class="ttc" id="structdg_1_1a_topology2d_html_a08dc0170234eb2a9b9fa36e24ee36cd3"><div class="ttname"><a href="structdg_1_1a_topology2d.html#a08dc0170234eb2a9b9fa36e24ee36cd3">dg::aTopology2d::size</a></div><div class="ttdeci">unsigned size() const </div><div class="ttdoc">The total number of points. </div><div class="ttdef"><b>Definition:</b> grid.h:354</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_aea3dd40d084245e88d5df87b48b29b28"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#aea3dd40d084245e88d5df87b48b29b28">dg::aMPITopology2d::size</a></div><div class="ttdeci">unsigned size() const </div><div class="ttdoc">The total global number of points. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:137</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_acd77a57371c8a2806e5e243a126a63bb"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#acd77a57371c8a2806e5e243a126a63bb">dg::aMPITopology3d::y0</a></div><div class="ttdeci">double y0() const </div><div class="ttdoc">Return global y0. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:341</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a2099d0ee39f50542d521ed520fd04172"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a2099d0ee39f50542d521ed520fd04172">dg::aMPITopology3d::bcy</a></div><div class="ttdeci">bc bcy() const </div><div class="ttdoc">global y boundary </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:434</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_ab8f3ac8db800e03bd42011fd77af6890"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#ab8f3ac8db800e03bd42011fd77af6890">dg::aMPITopology2d::~aMPITopology2d</a></div><div class="ttdeci">~aMPITopology2d()</div><div class="ttdoc">disallow deletion through base class pointer </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:251</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a7f3c70959bc51da96292fdd3fff219ec"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a7f3c70959bc51da96292fdd3fff219ec">dg::aMPITopology3d::local_size</a></div><div class="ttdeci">unsigned local_size() const </div><div class="ttdoc">The total local number of points. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:466</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_a5089d0560581c0d5f1b87c6c615469a4"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#a5089d0560581c0d5f1b87c6c615469a4">dg::aMPITopology2d::multiplyCellNumbers</a></div><div class="ttdeci">void multiplyCellNumbers(double fx, double fy)</div><div class="ttdoc">Multiply the number of cells with a given factor. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:172</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a23fd057296e9999845509c74aa5ebd5b"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a23fd057296e9999845509c74aa5ebd5b">dg::aMPITopology3d::~aMPITopology3d</a></div><div class="ttdeci">~aMPITopology3d()</div><div class="ttdoc">disallow deletion through base class pointer </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:543</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_a9ed7ac5135e84649b9c15a9537cadfdb"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#a9ed7ac5135e84649b9c15a9537cadfdb">dg::aMPITopology2d::hy</a></div><div class="ttdeci">double hy() const </div><div class="ttdoc">Return global hy. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:89</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_a600f66398bd783c055a04d8b73116b24"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#a600f66398bd783c055a04d8b73116b24">dg::aMPITopology2d::Ny</a></div><div class="ttdeci">unsigned Ny() const </div><div class="ttdoc">Return the global number of cells. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:108</div></div>
<div class="ttc" id="structdg_1_1a_topology2d_html_ad43f5d400ad3e2d4f3abdd0517576b84"><div class="ttname"><a href="structdg_1_1a_topology2d.html#ad43f5d400ad3e2d4f3abdd0517576b84">dg::aTopology2d::display</a></div><div class="ttdeci">void display(std::ostream &amp;os=std::cout) const </div><div class="ttdoc">Display. </div><div class="ttdef"><b>Definition:</b> grid.h:360</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a4844168330e79f6083175be424640c9b"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a4844168330e79f6083175be424640c9b">dg::aMPITopology3d::bcz</a></div><div class="ttdeci">bc bcz() const </div><div class="ttdoc">global z boundary </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:440</div></div>
<div class="ttc" id="structdg_1_1_two_dimensional_tag_html"><div class="ttname"><a href="structdg_1_1_two_dimensional_tag.html">dg::TwoDimensionalTag</a></div><div class="ttdoc">2d </div><div class="ttdef"><b>Definition:</b> topological_traits.h:18</div></div>
<div class="ttc" id="namespacedg_html"><div class="ttname"><a href="namespacedg.html">dg</a></div><div class="ttdoc">This is the namespace for all functions and classes defined and used by the discontinuous Galerkin so...</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_ae4616e1cd8c87598aec7d8d0d95a2597"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#ae4616e1cd8c87598aec7d8d0d95a2597">dg::aMPITopology2d::do_set</a></div><div class="ttdeci">virtual void do_set(unsigned new_n, unsigned new_Nx, unsigned new_Ny)=0</div><div class="ttdoc">This function has an implementation. </div></div>
<div class="ttc" id="structdg_1_1a_topology2d_html_adb5dab9b977ab75682d745c8d932a3ac"><div class="ttname"><a href="structdg_1_1a_topology2d.html#adb5dab9b977ab75682d745c8d932a3ac">dg::aTopology2d::Nx</a></div><div class="ttdeci">unsigned Nx() const </div><div class="ttdoc">number of cells in x </div><div class="ttdef"><b>Definition:</b> grid.h:299</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_acbdee1f83a4a29d6f5c1f9f5d3f36bf0"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#acbdee1f83a4a29d6f5c1f9f5d3f36bf0">dg::aMPITopology2d::communicator</a></div><div class="ttdeci">MPI_Comm communicator() const </div><div class="ttdoc">Return mpi cartesian communicator that is used in this grid. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:126</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_ae47851a2135233032b9996aaa3c5512d"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#ae47851a2135233032b9996aaa3c5512d">dg::aMPITopology2d::Nx</a></div><div class="ttdeci">unsigned Nx() const </div><div class="ttdoc">Return the global number of cells. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:101</div></div>
<div class="ttc" id="structdg_1_1a_topology2d_html_ac6e0387e5428733add17d958f043033b"><div class="ttname"><a href="structdg_1_1a_topology2d.html#ac6e0387e5428733add17d958f043033b">dg::aTopology2d::hy</a></div><div class="ttdeci">double hy() const </div><div class="ttdoc">cell size in y </div><div class="ttdef"><b>Definition:</b> grid.h:287</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_ac28f9801458d0789776ee59541849359"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#ac28f9801458d0789776ee59541849359">dg::aMPITopology3d::local</a></div><div class="ttdeci">const Grid3d &amp; local() const </div><div class="ttdoc">Return a non-MPI grid local for the calling process. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:538</div></div>
<div class="ttc" id="structdg_1_1a_topology2d_html_a9013407c847ed51b70f9e73b5d42d77c"><div class="ttname"><a href="structdg_1_1a_topology2d.html#a9013407c847ed51b70f9e73b5d42d77c">dg::aTopology2d::y0</a></div><div class="ttdeci">double y0() const </div><div class="ttdoc">left boundary in y </div><div class="ttdef"><b>Definition:</b> grid.h:257</div></div>
<div class="ttc" id="structdg_1_1_grid2d_html"><div class="ttname"><a href="structdg_1_1_grid2d.html">dg::Grid2d</a></div><div class="ttdoc">The simplest implementation of aTopology2d. </div><div class="ttdef"><b>Definition:</b> grid.h:711</div></div>
<div class="ttc" id="structdg_1_1_three_dimensional_tag_html"><div class="ttname"><a href="structdg_1_1_three_dimensional_tag.html">dg::ThreeDimensionalTag</a></div><div class="ttdoc">3d </div><div class="ttdef"><b>Definition:</b> topological_traits.h:19</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_a1e3e8416ca3dce951b2343c6cac22c90"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#a1e3e8416ca3dce951b2343c6cac22c90">dg::aMPITopology2d::operator=</a></div><div class="ttdeci">aMPITopology2d &amp; operator=(const aMPITopology2d &amp;src)</div><div class="ttdoc">copydoc aTopology2d::operator()(const aTopology2d&amp;) </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:267</div></div>
<div class="ttc" id="structdg_1_1a_topology2d_html_a3b40c025394f50443d24b93035dfc51e"><div class="ttname"><a href="structdg_1_1a_topology2d.html#a3b40c025394f50443d24b93035dfc51e">dg::aTopology2d::x0</a></div><div class="ttdeci">double x0() const </div><div class="ttdoc">Left boundary in x. </div><div class="ttdef"><b>Definition:</b> grid.h:245</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a0a28e58716749d39fc4a477e7236502c"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a0a28e58716749d39fc4a477e7236502c">dg::aMPITopology3d::operator=</a></div><div class="ttdeci">aMPITopology3d &amp; operator=(const aMPITopology3d &amp;src)</div><div class="ttdef"><b>Definition:</b> mpi_grid.h:561</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_adc028300491ec43cb3d8d24d62c7e54b"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#adc028300491ec43cb3d8d24d62c7e54b">dg::aMPITopology2d::bcx</a></div><div class="ttdeci">bc bcx() const </div><div class="ttdoc">global x boundary </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:114</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a3cbe2e92a646139f4db30d3b0226c9b6"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a3cbe2e92a646139f4db30d3b0226c9b6">dg::aMPITopology3d::z1</a></div><div class="ttdeci">double z1() const </div><div class="ttdoc">Return global z1. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:359</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_ae76296971b73308b2463960f74d39ccc"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#ae76296971b73308b2463960f74d39ccc">dg::aMPITopology3d::y1</a></div><div class="ttdeci">double y1() const </div><div class="ttdoc">Return global y1. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:347</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a00cde0b1e4bad949ca2942c159fbaaa4"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a00cde0b1e4bad949ca2942c159fbaaa4">dg::aMPITopology3d::x0</a></div><div class="ttdeci">double x0() const </div><div class="ttdoc">Return global x0. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:329</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_a6756255527d688928ac3355df1a92c94"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#a6756255527d688928ac3355df1a92c94">dg::aMPITopology2d::hx</a></div><div class="ttdeci">double hx() const </div><div class="ttdoc">Return global hx. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:83</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_ac62b59dd5d174212a9636458453cc73f"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#ac62b59dd5d174212a9636458453cc73f">dg::aMPITopology2d::local</a></div><div class="ttdeci">const Grid2d &amp; local() const </div><div class="ttdoc">Return a non-MPI grid local for the calling process. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:238</div></div>
<div class="ttc" id="structdg_1_1a_topology2d_html_a2f5046ddad7754b4eafb0787b47373d9"><div class="ttname"><a href="structdg_1_1a_topology2d.html#a2f5046ddad7754b4eafb0787b47373d9">dg::aTopology2d::y1</a></div><div class="ttdeci">double y1() const </div><div class="ttdoc">Right boundary in y. </div><div class="ttdef"><b>Definition:</b> grid.h:263</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_a6f07eac8e87257c46dcbd6405faf319b"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#a6f07eac8e87257c46dcbd6405faf319b">dg::aMPITopology2d::x1</a></div><div class="ttdeci">double x1() const </div><div class="ttdoc">Return global x1. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:53</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_add3eaef22b683eddc9db26210064d9a7"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#add3eaef22b683eddc9db26210064d9a7">dg::aMPITopology2d::dimensionality</a></div><div class="ttdeci">TwoDimensionalTag dimensionality</div><div class="ttdef"><b>Definition:</b> mpi_grid.h:40</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html">dg::aMPITopology2d</a></div><div class="ttdoc">2D MPI abstract grid class </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:37</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a2ae109f81ca4f91e63ecd20d63f28a19"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a2ae109f81ca4f91e63ecd20d63f28a19">dg::aMPITopology3d::x1</a></div><div class="ttdeci">double x1() const </div><div class="ttdoc">Return global x1. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:335</div></div>
<div class="ttc" id="structdg_1_1_m_p_i_grid3d_html"><div class="ttname"><a href="structdg_1_1_m_p_i_grid3d.html">dg::MPIGrid3d</a></div><div class="ttdoc">The simplest implementation of aMPITopology3d. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:695</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_a12e826ed7763b1e97ba156f6164c9d00"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#a12e826ed7763b1e97ba156f6164c9d00">dg::aMPITopology2d::aMPITopology2d</a></div><div class="ttdeci">aMPITopology2d(const aMPITopology2d &amp;src)</div><div class="ttdoc">copydoc aTopology2d::aTopology2d(const aTopology2d&amp;) </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:265</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_adee8503742abba153b172d91c0a4cc1e"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#adee8503742abba153b172d91c0a4cc1e">dg::aMPITopology3d::hz</a></div><div class="ttdeci">double hz() const </div><div class="ttdoc">Return global hz. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:395</div></div>
<div class="ttc" id="structdg_1_1a_topology2d_html_a8acfe8e4f9f53bbc17f8b85d4dc5df9b"><div class="ttname"><a href="structdg_1_1a_topology2d.html#a8acfe8e4f9f53bbc17f8b85d4dc5df9b">dg::aTopology2d::n</a></div><div class="ttdeci">unsigned n() const </div><div class="ttdoc">number of polynomial coefficients in x and y </div><div class="ttdef"><b>Definition:</b> grid.h:293</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_a3cf33eca5e3d6ca607d1e49b3638974b"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#a3cf33eca5e3d6ca607d1e49b3638974b">dg::aMPITopology2d::aMPITopology2d</a></div><div class="ttdeci">aMPITopology2d(double x0, double x1, double y0, double y1, unsigned n, unsigned Nx, unsigned Ny, bc bcx, bc bcy, MPI_Comm comm)</div><div class="ttdoc">Construct a 2D grid. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:258</div></div>
<div class="ttc" id="structdg_1_1a_topology2d_html_a2d62964fdcfb173dffba2784135a706c"><div class="ttname"><a href="structdg_1_1a_topology2d.html#a2d62964fdcfb173dffba2784135a706c">dg::aTopology2d::bcx</a></div><div class="ttdeci">bc bcx() const </div><div class="ttdoc">boundary conditions in x </div><div class="ttdef"><b>Definition:</b> grid.h:311</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a731a565d96b042fa52dee23965ce7692"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a731a565d96b042fa52dee23965ce7692">dg::aMPITopology3d::lx</a></div><div class="ttdeci">double lx() const </div><div class="ttdoc">Return global lx. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:365</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a349d987c1a9ad6756d7c35dbf3ab31d3"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a349d987c1a9ad6756d7c35dbf3ab31d3">dg::aMPITopology3d::lz</a></div><div class="ttdeci">double lz() const </div><div class="ttdoc">Return global lz. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:377</div></div>
<div class="ttc" id="structdg_1_1a_topology2d_html_a142604ec8c0486a4600b2c62f8146fc6"><div class="ttname"><a href="structdg_1_1a_topology2d.html#a142604ec8c0486a4600b2c62f8146fc6">dg::aTopology2d::lx</a></div><div class="ttdeci">double lx() const </div><div class="ttdoc">length of x </div><div class="ttdef"><b>Definition:</b> grid.h:269</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_a82bb37573b4a2c4fc3932b8be0c00a25"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#a82bb37573b4a2c4fc3932b8be0c00a25">dg::aMPITopology2d::ly</a></div><div class="ttdeci">double ly() const </div><div class="ttdoc">Return global ly. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:77</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_a3ad794d304faf7e108a06876170d065d"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#a3ad794d304faf7e108a06876170d065d">dg::aMPITopology2d::pidOf</a></div><div class="ttdeci">int pidOf(double x, double y) const </div><div class="ttdoc">Returns the pid of the process that holds the local grid surrounding the given point. </div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_ab77f16bb1f6c1e496f54b65cb6d60eef"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#ab77f16bb1f6c1e496f54b65cb6d60eef">dg::aMPITopology2d::local2globalIdx</a></div><div class="ttdeci">bool local2globalIdx(int localIdx, int PID, int &amp;globalIdx) const </div><div class="ttdoc">Map a local index plus the PID to a global vector index. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:191</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_aa1112ace51cdf7c72979a67bf62748e1"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#aa1112ace51cdf7c72979a67bf62748e1">dg::aMPITopology3d::n</a></div><div class="ttdeci">unsigned n() const </div><div class="ttdoc">Return n. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:401</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_a78b58d3029b332b2be8fe8e7f152fd7a"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#a78b58d3029b332b2be8fe8e7f152fd7a">dg::aMPITopology2d::dlt</a></div><div class="ttdeci">const DLT&lt; double &gt; &amp; dlt() const </div><div class="ttdoc">The Discrete Legendre Transformation. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:132</div></div>
<div class="ttc" id="structdg_1_1a_topology2d_html_adc32942008d8c126ff323df4bd14fdbb"><div class="ttname"><a href="structdg_1_1a_topology2d.html#adc32942008d8c126ff323df4bd14fdbb">dg::aTopology2d::Ny</a></div><div class="ttdeci">unsigned Ny() const </div><div class="ttdoc">number of cells in y </div><div class="ttdef"><b>Definition:</b> grid.h:305</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a7dd302b97be6418b70d6d3268ae498f3"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a7dd302b97be6418b70d6d3268ae498f3">dg::aMPITopology3d::memory_category</a></div><div class="ttdeci">MPITag memory_category</div><div class="ttdef"><b>Definition:</b> mpi_grid.h:321</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_aa55c7291d6354ad7f86348d94fa32450"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#aa55c7291d6354ad7f86348d94fa32450">dg::aMPITopology2d::n</a></div><div class="ttdeci">unsigned n() const </div><div class="ttdoc">Return n. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:95</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_added9e4b0ee0d4ffcc73e0d9ec685d2b"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#added9e4b0ee0d4ffcc73e0d9ec685d2b">dg::aMPITopology2d::local_size</a></div><div class="ttdeci">unsigned local_size() const </div><div class="ttdoc">The total local number of points. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:142</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a23bcf1fed27b298056d64c70ec5e0cb9"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a23bcf1fed27b298056d64c70ec5e0cb9">dg::aMPITopology3d::hy</a></div><div class="ttdeci">double hy() const </div><div class="ttdoc">Return global hy. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:389</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_a37d48b883067b9a2dad905a4508ca06d"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#a37d48b883067b9a2dad905a4508ca06d">dg::aMPITopology2d::y0</a></div><div class="ttdeci">double y0() const </div><div class="ttdoc">Return global y0. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:59</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_afb32b0e071022f6cdfc19f6bc2665281"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#afb32b0e071022f6cdfc19f6bc2665281">dg::aMPITopology2d::x0</a></div><div class="ttdeci">double x0() const </div><div class="ttdoc">Return global x0. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:47</div></div>
<div class="ttc" id="grid_8h_html"><div class="ttname"><a href="grid_8h.html">grid.h</a></div><div class="ttdoc">base topology classes </div></div>
<div class="ttc" id="group__creation_html_gga59440bdf436f2874b49aa52b670ed364a948704f60491461974ce4fe6339778b3"><div class="ttname"><a href="group__creation.html#gga59440bdf436f2874b49aa52b670ed364a948704f60491461974ce4fe6339778b3">dg::PER</a></div><div class="ttdoc">periodic boundaries </div><div class="ttdef"><b>Definition:</b> enums.h:17</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a1775452b98ced34501f03ccddd7701d1"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a1775452b98ced34501f03ccddd7701d1">dg::aMPITopology3d::global</a></div><div class="ttdeci">const Grid3d &amp; global() const </div><div class="ttdoc">Return the global non-MPI grid. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:540</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_a5dc72392331fd90ed1ce9905bff862d3"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#a5dc72392331fd90ed1ce9905bff862d3">dg::aMPITopology2d::memory_category</a></div><div class="ttdeci">MPITag memory_category</div><div class="ttdef"><b>Definition:</b> mpi_grid.h:39</div></div>
<div class="ttc" id="structdg_1_1a_topology2d_html_a42f590d05c9cce424f5ff90f9f9f5c5c"><div class="ttname"><a href="structdg_1_1a_topology2d.html#a42f590d05c9cce424f5ff90f9f9f5c5c">dg::aTopology2d::dlt</a></div><div class="ttdeci">const DLT&lt; double &gt; &amp; dlt() const </div><div class="ttdoc">discrete legendre trafo </div><div class="ttdef"><b>Definition:</b> grid.h:323</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_ade09cb61661db2a88e6c54645b204afc"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#ade09cb61661db2a88e6c54645b204afc">dg::aMPITopology3d::z0</a></div><div class="ttdeci">double z0() const </div><div class="ttdoc">Return global z0. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:353</div></div>
<div class="ttc" id="structdg_1_1a_topology2d_html_a76abaddbe25813215241b0f50e774865"><div class="ttname"><a href="structdg_1_1a_topology2d.html#a76abaddbe25813215241b0f50e774865">dg::aTopology2d::ly</a></div><div class="ttdeci">double ly() const </div><div class="ttdoc">length of y </div><div class="ttdef"><b>Definition:</b> grid.h:275</div></div>
<div class="ttc" id="group__creation_html_ga59440bdf436f2874b49aa52b670ed364"><div class="ttname"><a href="group__creation.html#ga59440bdf436f2874b49aa52b670ed364">dg::bc</a></div><div class="ttdeci">bc</div><div class="ttdoc">Switch between boundary conditions. </div><div class="ttdef"><b>Definition:</b> enums.h:16</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a9dcc823476daa7f1472b12759efba837"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a9dcc823476daa7f1472b12759efba837">dg::aMPITopology3d::dimensionality</a></div><div class="ttdeci">ThreeDimensionalTag dimensionality</div><div class="ttdef"><b>Definition:</b> mpi_grid.h:322</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a92be21ea57b8be612301124cf15aad2d"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a92be21ea57b8be612301124cf15aad2d">dg::aMPITopology3d::global2localIdx</a></div><div class="ttdeci">bool global2localIdx(int globalIdx, int &amp;localIdx, int &amp;PID) const </div><div class="ttdoc">Map a global vector index to a local vector Index and the corresponding PID. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:518</div></div>
<div class="ttc" id="structdg_1_1a_topology2d_html_a9a6354d37c67bce0c514dee708a9f7fd"><div class="ttname"><a href="structdg_1_1a_topology2d.html#a9a6354d37c67bce0c514dee708a9f7fd">dg::aTopology2d::x1</a></div><div class="ttdeci">double x1() const </div><div class="ttdoc">Right boundary in x. </div><div class="ttdef"><b>Definition:</b> grid.h:251</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_a1581d96dca0aceefd24742056a0c982f"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#a1581d96dca0aceefd24742056a0c982f">dg::aMPITopology2d::global2localIdx</a></div><div class="ttdeci">bool global2localIdx(int globalIdx, int &amp;localIdx, int &amp;PID) const </div><div class="ttdoc">Map a global vector index to a local vector Index and the corresponding PID. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:212</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a28958c5bb8b2ad63de0f4fdbc2849282"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a28958c5bb8b2ad63de0f4fdbc2849282">dg::aMPITopology3d::do_set</a></div><div class="ttdeci">virtual void do_set(unsigned new_n, unsigned new_Nx, unsigned new_Ny, unsigned new_Nz)=0</div></div>
<div class="ttc" id="structdg_1_1_grid3d_html"><div class="ttname"><a href="structdg_1_1_grid3d.html">dg::Grid3d</a></div><div class="ttdoc">The simplest implementation of aTopology3d. </div><div class="ttdef"><b>Definition:</b> grid.h:734</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a7f738622683822e17203a3914353b1ec"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a7f738622683822e17203a3914353b1ec">dg::aMPITopology3d::multiplyCellNumbers</a></div><div class="ttdeci">void multiplyCellNumbers(double fx, double fy)</div><div class="ttdoc">Multiply the number of cells with a given factor. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:490</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a40f53efc9fed790cf62235855ba6da41"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a40f53efc9fed790cf62235855ba6da41">dg::aMPITopology3d::dlt</a></div><div class="ttdeci">const DLT&lt; double &gt; &amp; dlt() const </div><div class="ttdoc">The Discrete Legendre Transformation. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:456</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_a563be81b6ff55e594a2946d36ac16939"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#a563be81b6ff55e594a2946d36ac16939">dg::aMPITopology2d::y1</a></div><div class="ttdeci">double y1() const </div><div class="ttdoc">Return global y1. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:65</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_a2743820bc1348550146db008fdd55e1f"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#a2743820bc1348550146db008fdd55e1f">dg::aMPITopology2d::bcy</a></div><div class="ttdeci">bc bcy() const </div><div class="ttdoc">global y boundary </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:120</div></div>
<div class="ttc" id="structdg_1_1_m_p_i_tag_html"><div class="ttname"><a href="structdg_1_1_m_p_i_tag.html">dg::MPITag</a></div><div class="ttdoc">distributed memory system </div><div class="ttdef"><b>Definition:</b> topological_traits.h:13</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_aa432bebd8a88e4ae68c14be50c63f3bd"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#aa432bebd8a88e4ae68c14be50c63f3bd">dg::aMPITopology3d::size</a></div><div class="ttdeci">unsigned size() const </div><div class="ttdoc">The total global number of points. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:461</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_af5e4b7a823b5a7acd457ba27c4e95024"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#af5e4b7a823b5a7acd457ba27c4e95024">dg::aMPITopology3d::display</a></div><div class="ttdeci">void display(std::ostream &amp;os=std::cout) const </div><div class="ttdoc">Display global and local grid paramters. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:472</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology2d_html_ab582e50841635d326233b60dea676586"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology2d.html#ab582e50841635d326233b60dea676586">dg::aMPITopology2d::lx</a></div><div class="ttdeci">double lx() const </div><div class="ttdoc">Return global lx. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:71</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a26dfa70dc4ecacd961741506187b6733"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a26dfa70dc4ecacd961741506187b6733">dg::aMPITopology3d::hx</a></div><div class="ttdeci">double hx() const </div><div class="ttdoc">Return global hx. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:383</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_ac77bafcdcd9cb267c46168f66590cd3c"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#ac77bafcdcd9cb267c46168f66590cd3c">dg::aMPITopology3d::Ny</a></div><div class="ttdeci">unsigned Ny() const </div><div class="ttdoc">Return the global number of cells. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:415</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html">dg::aMPITopology3d</a></div><div class="ttdoc">3D MPI Grid class </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:319</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_acb9c894885849f0a246d7292f76634c7"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#acb9c894885849f0a246d7292f76634c7">dg::aMPITopology3d::get_perp_comm</a></div><div class="ttdeci">MPI_Comm get_perp_comm() const </div><div class="ttdoc">MPI Cartesian communicator in the first two dimensions (x and y) </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:450</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_aaa799c1da21b8d02c965ddc691660ab0"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#aaa799c1da21b8d02c965ddc691660ab0">dg::aMPITopology3d::bcx</a></div><div class="ttdeci">bc bcx() const </div><div class="ttdoc">global x boundary </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:428</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a2e02320a66d1a411a66f3d2b97623f88"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a2e02320a66d1a411a66f3d2b97623f88">dg::aMPITopology3d::communicator</a></div><div class="ttdeci">MPI_Comm communicator() const </div><div class="ttdoc">Return mpi cartesian communicator that is used in this grid. </div><div class="ttdef"><b>Definition:</b> mpi_grid.h:445</div></div>
<div class="ttc" id="structdg_1_1a_topology2d_html_a13d71f34aa33577fb32177439822fbfd"><div class="ttname"><a href="structdg_1_1a_topology2d.html#a13d71f34aa33577fb32177439822fbfd">dg::aTopology2d::hx</a></div><div class="ttdeci">double hx() const </div><div class="ttdoc">cell size in x </div><div class="ttdef"><b>Definition:</b> grid.h:281</div></div>
<div class="ttc" id="structdg_1_1a_m_p_i_topology3d_html_a76ca4d836a3f6bbca5b5112f4d4b58cc"><div class="ttname"><a href="structdg_1_1a_m_p_i_topology3d.html#a76ca4d836a3f6bbca5b5112f4d4b58cc">dg::aMPITopology3d::aMPITopology3d</a></div><div class="ttdeci">aMPITopology3d(const aMPITopology3d &amp;src)</div><div class="ttdef"><b>Definition:</b> mpi_grid.h:558</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_8c739bbef76d64b22d6b0911c526dd76.html">backend</a></li><li class="navelem"><a class="el" href="mpi__grid_8h.html">mpi_grid.h</a></li>
    <li class="footer">Generated on Wed Nov 15 2017 10:37:28 for Discontinuous Galerkin Library by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
